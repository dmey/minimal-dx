<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Library for simulating the performance of simple air-to-air air conditioner (AC).">
    
    <meta name="author" content="dmey" >
    <link rel="icon" href="../favicon.png">

    <title>GetTDewPointFromVapPres &ndash; MinimalDX</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">MinimalDX </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>GetTDewPointFromVapPres
      <small>Function</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.9% of total for procedures.">40 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/psychrolib.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/psychrolib.f90.html'>psychrolib.f90</a></li>
    
     <li><a href='../module/psychrolib.html'>psychrolib</a></li>
    
  
     <li class="active">GetTDewPointFromVapPres</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/gettdewpointfromvappres.html#src">GetTDewPointFromVapPres</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public function GetTDewPointFromVapPres(TDryBulb, VapPres) result(TDewPoint)
    
    
   
</h2>
    
  


    
    <p>Return dew-point temperature given dry-bulb temperature and vapor pressure.
 References:
 ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 and 6
 Notes:
 The dew point temperature is solved by inverting the equation giving water vapor pressure
 at saturation from temperature rather than using the regressions provided
 by ASHRAE (eqn. 37 and 38) which are much less accurate and have a
 narrower range of validity.
 The Newton-Raphson (NR) method is used on the logarithm of water vapour
 pressure as a function of temperature, which is a very smooth function
 Convergence is usually achieved in 3 to 5 iterations.
 TDryBulb is not really needed here, just used for convenience.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tdrybulb~10"></span>real,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>TDryBulb</strong></td><td><p>Dry-bulb temperature in 째F [IP] or 째C [SI]</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vappres~3"></span>real,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>VapPres</strong></td><td><p>Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    
    
    
    
   <h3>Return Value <small><span class="anchor" id="variable-tdewpoint~5"></span>real
  </small></h3>
    <p>Dew-point temperature in 째F [IP] or 째C [SI]</p>
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~gettdewpointfromvappres~~CallsGraph Pages: 1 -->
<svg id="procgettdewpointfromvappresCallsGraph" width="492pt" height="116pt"
 viewBox="0.00 0.00 492.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~gettdewpointfromvappres~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>proc~~gettdewpointfromvappres~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-112 488,-112 488,4 -4,4"/>
<!-- proc~gettdewpointfromvappres -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_node1" class="node"><title>proc~gettdewpointfromvappres</title>
<polygon fill="none" stroke="black" points="155,-68 0,-68 0,-44 155,-44 155,-68"/>
<text text-anchor="middle" x="77.5" y="-53.6" font-family="Helvetica,sans-Serif" font-size="10.50">GetTDewPointFromVapPres</text>
</g>
<!-- proc~isip -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_node2" class="node"><title>proc~isip</title>
<g id="a_proc~~gettdewpointfromvappres~~CallsGraph_node2"><a xlink:href=".././proc/isip.html" xlink:title="isIP">
<polygon fill="#d94e8f" stroke="#d94e8f" points="427.5,-108 373.5,-108 373.5,-84 427.5,-84 427.5,-108"/>
<text text-anchor="middle" x="400.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">isIP</text>
</a>
</g>
</g>
<!-- proc~gettdewpointfromvappres&#45;&gt;proc~isip -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge1" class="edge"><title>proc~gettdewpointfromvappres&#45;&gt;proc~isip</title>
<path fill="none" stroke="#ff0000" d="M137.301,-68.0513C154.55,-71.2948 173.484,-74.5726 191,-77 251.114,-85.331 321.505,-90.8771 363.197,-93.7271"/>
<polygon fill="#ff0000" stroke="#ff0000" points="363.195,-97.2347 373.406,-94.4101 363.662,-90.2503 363.195,-97.2347"/>
</g>
<!-- proc~getsatvappres -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_node3" class="node"><title>proc~getsatvappres</title>
<g id="a_proc~~gettdewpointfromvappres~~CallsGraph_node3"><a xlink:href=".././proc/getsatvappres.html" xlink:title="GetSatVapPres">
<polygon fill="#d94e8f" stroke="#d94e8f" points="281,-26 191,-26 191,-2 281,-2 281,-26"/>
<text text-anchor="middle" x="236" y="-11.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetSatVapPres</text>
</a>
</g>
</g>
<!-- proc~gettdewpointfromvappres&#45;&gt;proc~getsatvappres -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge2" class="edge"><title>proc~gettdewpointfromvappres&#45;&gt;proc~getsatvappres</title>
<path fill="none" stroke="#ff0000" d="M123.347,-43.9645C141.339,-39.1359 162.232,-33.5288 181.045,-28.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.207,-31.7921 190.958,-25.8196 180.392,-25.0313 182.207,-31.7921"/>
</g>
<!-- proc~dlnpws_ -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_node4" class="node"><title>proc~dlnpws_</title>
<g id="a_proc~~gettdewpointfromvappres~~CallsGraph_node4"><a xlink:href=".././proc/dlnpws_.html" xlink:title="dLnPws_">
<polygon fill="#d94e8f" stroke="#d94e8f" points="265,-68 207,-68 207,-44 265,-44 265,-68"/>
<text text-anchor="middle" x="236" y="-53.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dLnPws_</text>
</a>
</g>
</g>
<!-- proc~gettdewpointfromvappres&#45;&gt;proc~dlnpws_ -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge3" class="edge"><title>proc~gettdewpointfromvappres&#45;&gt;proc~dlnpws_</title>
<path fill="none" stroke="#ff0000" d="M155.375,-56C169.748,-56 184.183,-56 196.739,-56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.802,-59.5001 206.802,-56 196.802,-52.5001 196.802,-59.5001"/>
</g>
<!-- proc~getsatvappres&#45;&gt;proc~isip -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge4" class="edge"><title>proc~getsatvappres&#45;&gt;proc~isip</title>
<path fill="none" stroke="#00ff00" d="M266.339,-26.007C271.432,-28.6411 276.525,-31.6564 281,-35 300.161,-49.3149 296.53,-62.629 317,-75 330.977,-83.4472 348.259,-88.5147 363.389,-91.5463"/>
<polygon fill="#00ff00" stroke="#00ff00" points="362.993,-95.0309 373.452,-93.3363 364.219,-88.139 362.993,-95.0309"/>
</g>
<!-- proc~gettrankinefromtfahrenheit -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_node5" class="node"><title>proc~gettrankinefromtfahrenheit</title>
<g id="a_proc~~gettdewpointfromvappres~~CallsGraph_node5"><a xlink:href=".././proc/gettrankinefromtfahrenheit.html" xlink:title="GetTRankineFromTFahrenheit">
<polygon fill="#d94e8f" stroke="#d94e8f" points="484,-24 317,-24 317,-0 484,-0 484,-24"/>
<text text-anchor="middle" x="400.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTRankineFromTFahrenheit</text>
</a>
</g>
</g>
<!-- proc~getsatvappres&#45;&gt;proc~gettrankinefromtfahrenheit -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge5" class="edge"><title>proc~getsatvappres&#45;&gt;proc~gettrankinefromtfahrenheit</title>
<path fill="none" stroke="#00ff00" d="M281.404,-13.4535C289.306,-13.3562 297.799,-13.2517 306.474,-13.1449"/>
<polygon fill="#00ff00" stroke="#00ff00" points="306.762,-16.6418 316.718,-13.0189 306.675,-9.64229 306.762,-16.6418"/>
</g>
<!-- proc~gettkelvinfromtcelsius -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_node6" class="node"><title>proc~gettkelvinfromtcelsius</title>
<g id="a_proc~~gettdewpointfromvappres~~CallsGraph_node6"><a xlink:href=".././proc/gettkelvinfromtcelsius.html" xlink:title="GetTKelvinFromTCelsius">
<polygon fill="#d94e8f" stroke="#d94e8f" points="468.5,-66 332.5,-66 332.5,-42 468.5,-42 468.5,-66"/>
<text text-anchor="middle" x="400.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTKelvinFromTCelsius</text>
</a>
</g>
</g>
<!-- proc~getsatvappres&#45;&gt;proc~gettkelvinfromtcelsius -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge6" class="edge"><title>proc~getsatvappres&#45;&gt;proc~gettkelvinfromtcelsius</title>
<path fill="none" stroke="#00ff00" d="M281.404,-24.9302C299.733,-29.4419 321.235,-34.7348 340.834,-39.559"/>
<polygon fill="#00ff00" stroke="#00ff00" points="340.033,-42.9663 350.579,-41.958 341.706,-36.1692 340.033,-42.9663"/>
</g>
<!-- proc~dlnpws_&#45;&gt;proc~isip -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge7" class="edge"><title>proc~dlnpws_&#45;&gt;proc~isip</title>
<path fill="none" stroke="#0000ff" d="M265.305,-62.9675C292.555,-69.675 333.877,-79.8466 363.464,-87.1295"/>
<polygon fill="#0000ff" stroke="#0000ff" points="362.85,-90.583 373.397,-89.5747 364.524,-83.7859 362.85,-90.583"/>
</g>
<!-- proc~dlnpws_&#45;&gt;proc~gettrankinefromtfahrenheit -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge8" class="edge"><title>proc~dlnpws_&#45;&gt;proc~gettrankinefromtfahrenheit</title>
<path fill="none" stroke="#0000ff" d="M265.079,-47.6991C280.394,-43.2292 299.704,-37.6865 317,-33 324.809,-30.8841 333.051,-28.7128 341.183,-26.6067"/>
<polygon fill="#0000ff" stroke="#0000ff" points="342.2,-29.9593 351.012,-24.078 340.455,-23.18 342.2,-29.9593"/>
</g>
<!-- proc~dlnpws_&#45;&gt;proc~gettkelvinfromtcelsius -->
<g id="proc~~gettdewpointfromvappres~~CallsGraph_edge9" class="edge"><title>proc~dlnpws_&#45;&gt;proc~gettkelvinfromtcelsius</title>
<path fill="none" stroke="#0000ff" d="M265.305,-55.6516C281.174,-55.4563 301.816,-55.2023 322.133,-54.9522"/>
<polygon fill="#0000ff" stroke="#0000ff" points="322.423,-58.449 332.379,-54.8261 322.336,-51.4495 322.423,-58.449"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="590pt" height="32pt"
 viewBox="0.00 0.00 589.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 585.5,-28 585.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,-0 70,-0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="145.5,-24 88.5,-24 88.5,-0 145.5,-0 145.5,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="222,-24 164,-24 164,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="193" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-24 240.5,-24 240.5,-0 385.5,-0 385.5,-24"/>
<text text-anchor="middle" x="313" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="460,-24 404,-24 404,-0 460,-0 460,-24"/>
<text text-anchor="middle" x="432" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="581.5,-24 478.5,-24 478.5,-0 581.5,-0 581.5,-24"/>
<text text-anchor="middle" x="530" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~gettdewpointfromvappres~~CalledByGraph Pages: 1 -->
<svg id="procgettdewpointfromvappresCalledByGraph" width="641pt" height="142pt"
 viewBox="0.00 0.00 641.00 142.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~gettdewpointfromvappres~~CalledByGraph" class="graph" transform="scale(0.655419 0.655419) rotate(0) translate(4 213)">
<title>proc~~gettdewpointfromvappres~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-213 974,-213 974,4 -4,4"/>
<!-- proc~gettdewpointfromvappres -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node1" class="node"><title>proc~gettdewpointfromvappres</title>
<polygon fill="none" stroke="black" points="970,-128 815,-128 815,-104 970,-104 970,-128"/>
<text text-anchor="middle" x="892.5" y="-113.6" font-family="Helvetica,sans-Serif" font-size="10.50">GetTDewPointFromVapPres</text>
</g>
<!-- proc~gettdewpointfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node2" class="node"><title>proc~gettdewpointfromhumratio</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node2"><a xlink:href=".././proc/gettdewpointfromhumratio.html" xlink:title="GetTDewPointFromHumRatio">
<polygon fill="#d94e8f" stroke="#d94e8f" points="779,-149 616,-149 616,-125 779,-125 779,-149"/>
<text text-anchor="middle" x="697.5" y="-134.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTDewPointFromHumRatio</text>
</a>
</g>
</g>
<!-- proc~gettdewpointfromhumratio&#45;&gt;proc~gettdewpointfromvappres -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge1" class="edge"><title>proc~gettdewpointfromhumratio&#45;&gt;proc~gettdewpointfromvappres</title>
<path fill="none" stroke="#ff0000" d="M779.231,-128.216C787.695,-127.295 796.325,-126.356 804.851,-125.428"/>
<polygon fill="#ff0000" stroke="#ff0000" points="805.234,-128.907 814.797,-124.346 804.477,-121.948 805.234,-128.907"/>
</g>
<!-- proc~gettdewpointfromrelhum -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node3" class="node"><title>proc~gettdewpointfromrelhum</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node3"><a xlink:href=".././proc/gettdewpointfromrelhum.html" xlink:title="GetTDewPointFromRelHum">
<polygon fill="#d94e8f" stroke="#d94e8f" points="774,-107 621,-107 621,-83 774,-83 774,-107"/>
<text text-anchor="middle" x="697.5" y="-92.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTDewPointFromRelHum</text>
</a>
</g>
</g>
<!-- proc~gettdewpointfromrelhum&#45;&gt;proc~gettdewpointfromvappres -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge2" class="edge"><title>proc~gettdewpointfromrelhum&#45;&gt;proc~gettdewpointfromvappres</title>
<path fill="none" stroke="#ff0000" d="M774.225,-103.239C784.205,-104.325 794.495,-105.445 804.643,-106.549"/>
<polygon fill="#ff0000" stroke="#ff0000" points="804.405,-110.044 814.725,-107.646 805.163,-103.085 804.405,-110.044"/>
</g>
<!-- proc~gettdewpointfromtwetbulb -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node4" class="node"><title>proc~gettdewpointfromtwetbulb</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node4"><a xlink:href=".././proc/gettdewpointfromtwetbulb.html" xlink:title="GetTDewPointFromTWetBulb">
<polygon fill="#d94e8f" stroke="#d94e8f" points="567,-209 404,-209 404,-185 567,-185 567,-209"/>
<text text-anchor="middle" x="485.5" y="-194.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTDewPointFromTWetBulb</text>
</a>
</g>
</g>
<!-- proc~gettdewpointfromtwetbulb&#45;&gt;proc~gettdewpointfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge3" class="edge"><title>proc~gettdewpointfromtwetbulb&#45;&gt;proc~gettdewpointfromhumratio</title>
<path fill="none" stroke="#ff0000" d="M530.294,-184.946C545.985,-180.594 563.796,-175.617 580,-171 601.68,-164.822 625.587,-157.87 646.073,-151.869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="647.22,-155.18 655.831,-149.007 645.25,-148.463 647.22,-155.18"/>
</g>
<!-- proc~calcpsychrometricsfromrelhum -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node5" class="node"><title>proc~calcpsychrometricsfromrelhum</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node5"><a xlink:href=".././proc/calcpsychrometricsfromrelhum.html" xlink:title="CalcPsychrometricsFromRelHum">
<polygon fill="#d9534f" stroke="#d9534f" points="346.5,-192 167.5,-192 167.5,-168 346.5,-168 346.5,-192"/>
<text text-anchor="middle" x="257" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CalcPsychrometricsFromRelHum</text>
</a>
</g>
</g>
<!-- proc~calcpsychrometricsfromrelhum&#45;&gt;proc~gettdewpointfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge4" class="edge"><title>proc~calcpsychrometricsfromrelhum&#45;&gt;proc~gettdewpointfromhumratio</title>
<path fill="none" stroke="#ff0000" d="M346.737,-171.298C422.061,-163.912 529.697,-153.357 605.624,-145.911"/>
<polygon fill="#ff0000" stroke="#ff0000" points="606.043,-149.387 615.653,-144.928 605.359,-142.421 606.043,-149.387"/>
</g>
<!-- proc~gettwetbulbfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node7" class="node"><title>proc~gettwetbulbfromhumratio</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node7"><a xlink:href=".././proc/gettwetbulbfromhumratio.html" xlink:title="GetTWetBulbFromHumRatio">
<polygon fill="#d94e8f" stroke="#d94e8f" points="564,-129 407,-129 407,-105 564,-105 564,-129"/>
<text text-anchor="middle" x="485.5" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTWetBulbFromHumRatio</text>
</a>
</g>
</g>
<!-- proc~calcpsychrometricsfromrelhum&#45;&gt;proc~gettwetbulbfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge11" class="edge"><title>proc~calcpsychrometricsfromrelhum&#45;&gt;proc~gettwetbulbfromhumratio</title>
<path fill="none" stroke="#7f00ff" d="M322.414,-167.998C333.39,-165.401 344.599,-162.397 355,-159 371.644,-153.564 374.521,-148.917 391,-143 402.274,-138.952 414.497,-135.147 426.272,-131.763"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="427.347,-135.096 436.028,-129.022 425.454,-128.357 427.347,-135.096"/>
</g>
<!-- proc~calcpsychrometricsfromtwetbulb -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node6" class="node"><title>proc~calcpsychrometricsfromtwetbulb</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node6"><a xlink:href=".././proc/calcpsychrometricsfromtwetbulb.html" xlink:title="CalcPsychrometricsFromTWetBulb">
<polygon fill="#d9534f" stroke="#d9534f" points="580,-87 391,-87 391,-63 580,-63 580,-87"/>
<text text-anchor="middle" x="485.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CalcPsychrometricsFromTWetBulb</text>
</a>
</g>
</g>
<!-- proc~calcpsychrometricsfromtwetbulb&#45;&gt;proc~gettdewpointfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge5" class="edge"><title>proc~calcpsychrometricsfromtwetbulb&#45;&gt;proc~gettdewpointfromhumratio</title>
<path fill="none" stroke="#ff0000" d="M551.594,-87.0892C561.252,-89.6078 570.983,-92.5645 580,-96 597.104,-102.517 599.01,-109.192 616,-116 621.411,-118.168 627.117,-120.175 632.89,-122.017"/>
<polygon fill="#ff0000" stroke="#ff0000" points="632.043,-125.418 642.628,-124.961 634.069,-118.717 632.043,-125.418"/>
</g>
<!-- proc~gettwetbulbfromhumratio&#45;&gt;proc~gettdewpointfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge6" class="edge"><title>proc~gettwetbulbfromhumratio&#45;&gt;proc~gettdewpointfromhumratio</title>
<path fill="none" stroke="#ff0000" d="M564.1,-124.39C577.638,-125.68 591.83,-127.031 605.687,-128.351"/>
<polygon fill="#ff0000" stroke="#ff0000" points="605.416,-131.841 615.703,-129.305 606.08,-124.873 605.416,-131.841"/>
</g>
<!-- proc~calcminimaldxcooling -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node8" class="node"><title>proc~calcminimaldxcooling</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node8"><a xlink:href=".././proc/calcminimaldxcooling.html" xlink:title="CalcMinimalDXCooling">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-150 194,-150 194,-126 320,-126 320,-150"/>
<text text-anchor="middle" x="257" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CalcMinimalDXCooling</text>
</a>
</g>
</g>
<!-- proc~calcminimaldxcooling&#45;&gt;proc~gettwetbulbfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge7" class="edge"><title>proc~calcminimaldxcooling&#45;&gt;proc~gettwetbulbfromhumratio</title>
<path fill="none" stroke="#7f00ff" d="M320.192,-132.234C343.777,-130.047 371.1,-127.514 396.612,-125.149"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="397.029,-128.625 406.663,-124.217 396.383,-121.655 397.029,-128.625"/>
</g>
<!-- proc~gettwetbulbfromrelhum -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node9" class="node"><title>proc~gettwetbulbfromrelhum</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node9"><a xlink:href=".././proc/gettwetbulbfromrelhum.html" xlink:title="GetTWetBulbFromRelHum">
<polygon fill="#d94e8f" stroke="#d94e8f" points="330,-108 184,-108 184,-84 330,-84 330,-108"/>
<text text-anchor="middle" x="257" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTWetBulbFromRelHum</text>
</a>
</g>
</g>
<!-- proc~gettwetbulbfromrelhum&#45;&gt;proc~gettwetbulbfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge8" class="edge"><title>proc~gettwetbulbfromrelhum&#45;&gt;proc~gettwetbulbfromhumratio</title>
<path fill="none" stroke="#7f00ff" d="M330.289,-102.702C351.396,-104.659 374.697,-106.82 396.654,-108.855"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="396.355,-112.343 406.636,-109.781 397.002,-105.372 396.355,-112.343"/>
</g>
<!-- proc~calcpsychrometricsfromtdewpoint -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node10" class="node"><title>proc~calcpsychrometricsfromtdewpoint</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node10"><a xlink:href=".././proc/calcpsychrometricsfromtdewpoint.html" xlink:title="CalcPsychrometricsFromTDewPoint">
<polygon fill="#d9534f" stroke="#d9534f" points="355,-66 159,-66 159,-42 355,-42 355,-66"/>
<text text-anchor="middle" x="257" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CalcPsychrometricsFromTDewPoint</text>
</a>
</g>
</g>
<!-- proc~calcpsychrometricsfromtdewpoint&#45;&gt;proc~gettwetbulbfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge10" class="edge"><title>proc~calcpsychrometricsfromtdewpoint&#45;&gt;proc~gettwetbulbfromhumratio</title>
<path fill="none" stroke="#7f00ff" d="M326.638,-66.0255C336.306,-68.5342 346.006,-71.505 355,-75 372.265,-81.7093 373.761,-89.224 391,-96 396.792,-98.2765 402.888,-100.336 409.074,-102.194"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="408.267,-105.602 418.841,-104.948 410.167,-98.8651 408.267,-105.602"/>
</g>
<!-- proc~gettwetbulbfromtdewpoint -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node11" class="node"><title>proc~gettwetbulbfromtdewpoint</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node11"><a xlink:href=".././proc/gettwetbulbfromtdewpoint.html" xlink:title="GetTWetBulbFromTDewPoint">
<polygon fill="#d94e8f" stroke="#d94e8f" points="338.5,-24 175.5,-24 175.5,-0 338.5,-0 338.5,-24"/>
<text text-anchor="middle" x="257" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GetTWetBulbFromTDewPoint</text>
</a>
</g>
</g>
<!-- proc~gettwetbulbfromtdewpoint&#45;&gt;proc~gettwetbulbfromhumratio -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge9" class="edge"><title>proc~gettwetbulbfromtdewpoint&#45;&gt;proc~gettwetbulbfromhumratio</title>
<path fill="none" stroke="#7f00ff" d="M338.7,-23.7473C344.482,-26.2828 349.997,-29.3334 355,-33 381.012,-52.0625 365.062,-76.8371 391,-96 393.108,-97.557 395.31,-99.002 397.587,-100.343"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="396.204,-103.567 406.7,-105.014 399.398,-97.3379 396.204,-103.567"/>
</g>
<!-- proc~simminimaldxcooling -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_node12" class="node"><title>proc~simminimaldxcooling</title>
<g id="a_proc~~gettdewpointfromvappres~~CalledByGraph_node12"><a xlink:href=".././proc/simminimaldxcooling.html" xlink:title="SimMinimalDXCooling">
<polygon fill="#d9534f" stroke="#d9534f" points="123,-150 0,-150 0,-126 123,-126 123,-150"/>
<text text-anchor="middle" x="61.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">SimMinimalDXCooling</text>
</a>
</g>
</g>
<!-- proc~simminimaldxcooling&#45;&gt;proc~calcminimaldxcooling -->
<g id="proc~~gettdewpointfromvappres~~CalledByGraph_edge12" class="edge"><title>proc~simminimaldxcooling&#45;&gt;proc~calcminimaldxcooling</title>
<path fill="none" stroke="#ff0000" d="M123.194,-138C142.353,-138 163.714,-138 183.606,-138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.855,-141.5 193.855,-138 183.855,-134.5 183.855,-141.5"/>
</g>
</g>
</svg>
</div><script>var panprocgettdewpointfromvappresCalledByGraph = svgPanZoom('#procgettdewpointfromvappresCalledByGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="590pt" height="32pt"
 viewBox="0.00 0.00 589.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 585.5,-28 585.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,-0 70,-0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="145.5,-24 88.5,-24 88.5,-0 145.5,-0 145.5,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="222,-24 164,-24 164,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="193" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="385.5,-24 240.5,-24 240.5,-0 385.5,-0 385.5,-24"/>
<text text-anchor="middle" x="313" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="460,-24 404,-24 404,-0 460,-0 460,-24"/>
<text text-anchor="middle" x="432" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="581.5,-24 478.5,-24 478.5,-0 581.5,-0 581.5,-24"/>
<text text-anchor="middle" x="530" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/gettdewpointfromvappres.html#src">GetTDewPointFromVapPres</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">function </span><span class="n">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
    <span class="c">!+ Return dew-point temperature given dry-bulb temperature and vapor pressure.</span>
    <span class="c">!+ References:</span>
    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 and 6</span>
    <span class="c">!+ Notes:</span>
    <span class="c">!+ The dew point temperature is solved by inverting the equation giving water vapor pressure</span>
    <span class="c">!+ at saturation from temperature rather than using the regressions provided</span>
    <span class="c">!+ by ASHRAE (eqn. 37 and 38) which are much less accurate and have a</span>
    <span class="c">!+ narrower range of validity.</span>
    <span class="c">!+ The Newton-Raphson (NR) method is used on the logarithm of water vapour</span>
    <span class="c">!+ pressure as a function of temperature, which is a very smooth function</span>
    <span class="c">!+ Convergence is usually achieved in 3 to 5 iterations.</span>
    <span class="c">!+ TDryBulb is not really needed here, just used for convenience.</span>

    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TDryBulb</span>
      <span class="c">!+ Dry-bulb temperature in 째F [IP] or 째C [SI]</span>
    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">VapPres</span>
      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">TDewPoint</span>
      <span class="c">!+ Dew-point temperature in 째F [IP] or 째C [SI]</span>
    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">lnVP</span>
      <span class="c">!+ Natural logarithm of partial pressure of water vapor pressure in moist air</span>
    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">d_lnVP</span>
      <span class="c">!+ Derivative of function, calculated numerically</span>
    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">lnVP_iter</span>
      <span class="c">!+ Value of log of vapor water pressure used in NR calculation</span>
    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">TDewPoint_iter</span>
      <span class="c">!+ Value of TDewPoint used in NR calculation</span>
    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">BOUNDS</span>
      <span class="c">!+ Valid temperature range in 째F [IP] or 째C [SI]</span>
    <span class="kt">integer</span>             <span class="kd">::</span> <span class="nb">index</span>
      <span class="c">!+ Index used in the calculation</span>

    <span class="c">! Bounds and step size as a function of the system of units</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<span class="k">        </span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span><span class="mf">8.0</span>
        <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">39</span><span class="mf">2.0</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="mf">0.0</span>
        <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">20</span><span class="mf">0.0</span>
    <span class="k">end if</span>

    <span class="c">! Validity check -- bounds outside which a solution cannot be found</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">VapPres</span> <span class="o">&lt;</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">VapPres</span> <span class="o">&gt;</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: partial pressure of water vapor is outside range of validity of equations&quot;</span>
    <span class="k">end if</span>

    <span class="c">! We use NR to approximate the solution.</span>
    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">TDryBulb</span>
    <span class="n">lnVP</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">VapPres</span><span class="p">)</span>
    <span class="nb">index</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">do while</span> <span class="p">(.</span><span class="n">true</span><span class="p">.)</span>
      <span class="n">TDewPoint_iter</span> <span class="o">=</span> <span class="n">TDewPoint</span> <span class="c">! TDewPoint_iter used in NR calculation</span>
      <span class="n">lnVP_iter</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint_iter</span><span class="p">))</span>

      <span class="c">! Derivative of function, calculated analytically</span>
      <span class="n">d_lnVP</span> <span class="o">=</span> <span class="n">dLnPws_</span><span class="p">(</span><span class="n">TDewPoint_iter</span><span class="p">)</span>

      <span class="c">! New estimate, bounded by the search domain defined above</span>
      <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">TDewPoint_iter</span> <span class="o">-</span> <span class="p">(</span><span class="n">lnVP_iter</span> <span class="o">-</span> <span class="n">lnVP</span><span class="p">)</span> <span class="o">/</span> <span class="n">d_lnVP</span>
      <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">TDewPoint</span> <span class="o">-</span> <span class="n">TDewPoint_iter</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">PSYCHROLIB_TOLERANCE</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        exit</span>
<span class="k">      end if</span>

<span class="k">      if</span> <span class="p">(</span><span class="nb">index</span> <span class="o">&gt;</span> <span class="n">MAX_ITER_COUNT</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Convergence not reached in GetTDewPointFromVapPres. Stopping.&quot;</span>
      <span class="k">end if</span>

<span class="k">      </span><span class="nb">index</span> <span class="o">=</span> <span class="nb">index</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">end do</span>

<span class="k">  </span><span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span>
  <span class="k">end function </span><span class="n">GetTDewPointFromVapPres</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> MinimalDX was developed by dmey</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>