<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Library for simulating the performance of simple air-to-air air conditioner (AC).">
    
    <meta name="author" content="dmey" >
    <link rel="icon" href="../favicon.png">

    <title>psychrolib.f90 &ndash; MinimalDX</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">MinimalDX </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>psychrolib.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="61.6% of total for source files.">693 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/psychrolib.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">psychrolib.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/psychrolib.html">psychrolib</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/psychrolib.f90.html#src">psychrolib.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: sourcefile~~psychrolib.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilepsychrolibf90AfferentGraph" width="641pt" height="44pt"
 viewBox="0.00 0.00 641.00 43.92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~psychrolib.f90~~AfferentGraph" class="graph" transform="scale(0.844532 0.844532) rotate(0) translate(4 48)">
<title>sourcefile~~psychrolib.f90~~AfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-48 755,-48 755,4 -4,4"/>
<!-- sourcefile~psychrolib.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_node1" class="node"><title>sourcefile~psychrolib.f90</title>
<polygon fill="none" stroke="black" points="85,-44 0,-44 0,-20 85,-20 85,-44"/>
<text text-anchor="middle" x="42.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50">psychrolib.f90</text>
</g>
<!-- sourcefile~eplus_psychro.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_node2" class="node"><title>sourcefile~eplus_psychro.f90</title>
<g id="a_sourcefile~~psychrolib.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/eplus_psychro.f90.html" xlink:title="eplus_psychro.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="228,-24 121,-24 121,-0 228,-0 228,-24"/>
<text text-anchor="middle" x="174.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">eplus_psychro.f90</text>
</a>
</g>
</g>
<!-- sourcefile~eplus_psychro.f90&#45;&gt;sourcefile~psychrolib.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_edge1" class="edge"><title>sourcefile~eplus_psychro.f90&#45;&gt;sourcefile~psychrolib.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M120.999,-20.0771C112.388,-21.4018 103.474,-22.7732 94.891,-24.0937"/>
<polygon fill="#ff0000" stroke="#ff0000" points="94.3571,-20.6346 85.0056,-25.6145 95.4216,-27.5532 94.3571,-20.6346"/>
</g>
<!-- sourcefile~psychro_wrapper.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_node3" class="node"><title>sourcefile~psychro_wrapper.f90</title>
<g id="a_sourcefile~~psychrolib.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/psychro_wrapper.f90.html" xlink:title="psychro_wrapper.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="384,-44 264,-44 264,-20 384,-20 384,-44"/>
<text text-anchor="middle" x="324" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">psychro_wrapper.f90</text>
</a>
</g>
</g>
<!-- sourcefile~psychro_wrapper.f90&#45;&gt;sourcefile~psychrolib.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_edge2" class="edge"><title>sourcefile~psychro_wrapper.f90&#45;&gt;sourcefile~psychrolib.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.962,-32.7179C252.056,-32.8355 239.628,-32.9388 228,-33 180.445,-33.2503 168.555,-33.3068 121,-33 112.773,-32.9469 104.055,-32.8622 95.5503,-32.7639"/>
<polygon fill="#ff0000" stroke="#ff0000" points="95.3711,-29.2615 85.3289,-32.6385 95.2852,-36.261 95.3711,-29.2615"/>
</g>
<!-- sourcefile~psychro_wrapper.f90&#45;&gt;sourcefile~eplus_psychro.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_edge3" class="edge"><title>sourcefile~psychro_wrapper.f90&#45;&gt;sourcefile~eplus_psychro.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.856,-23.9805C255.537,-22.8525 246.96,-21.6894 238.57,-20.5519"/>
<polygon fill="#ff0000" stroke="#ff0000" points="238.841,-17.0566 228.461,-19.1812 237.9,-23.9932 238.841,-17.0566"/>
</g>
<!-- sourcefile~minimal_dx_cooling.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_node4" class="node"><title>sourcefile~minimal_dx_cooling.f90</title>
<g id="a_sourcefile~~psychrolib.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/minimal_dx_cooling.f90.html" xlink:title="minimal_dx_cooling.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="551,-44 420,-44 420,-20 551,-20 551,-44"/>
<text text-anchor="middle" x="485.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">minimal_dx_cooling.f90</text>
</a>
</g>
</g>
<!-- sourcefile~minimal_dx_cooling.f90&#45;&gt;sourcefile~psychro_wrapper.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_edge4" class="edge"><title>sourcefile~minimal_dx_cooling.f90&#45;&gt;sourcefile~psychro_wrapper.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M419.625,-32C411.286,-32 402.722,-32 394.316,-32"/>
<polygon fill="#00ffff" stroke="#00ffff" points="394.165,-28.5001 384.165,-32 394.165,-35.5001 394.165,-28.5001"/>
</g>
<!-- sourcefile~minimal_dx_cooling_driver.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_node5" class="node"><title>sourcefile~minimal_dx_cooling_driver.f90</title>
<g id="a_sourcefile~~psychrolib.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/minimal_dx_cooling_driver.f90.html" xlink:title="minimal_dx_cooling_driver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="751,-44 587,-44 587,-20 751,-20 751,-44"/>
<text text-anchor="middle" x="669" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">minimal_dx_cooling_driver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~minimal_dx_cooling_driver.f90&#45;&gt;sourcefile~minimal_dx_cooling.f90 -->
<g id="sourcefile~~psychrolib.f90~~AfferentGraph_edge5" class="edge"><title>sourcefile~minimal_dx_cooling_driver.f90&#45;&gt;sourcefile~minimal_dx_cooling.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.806,-32C578.284,-32 569.648,-32 561.204,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="561.019,-28.5001 551.019,-32 561.019,-35.5001 561.019,-28.5001"/>
</g>
</g>
</svg>
</div><script>var pansourcefilepsychrolibf90AfferentGraph = svgPanZoom('#sourcefilepsychrolibf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="198pt" height="32pt"
 viewBox="0.00 0.00 198.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 194,-28 194,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="69,-24 0,-24 0,-0 69,-0 69,-24"/>
<text text-anchor="middle" x="34.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="190,-24 87,-24 87,-0 190,-0 190,-24"/>
<text text-anchor="middle" x="138.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/psychrolib.html">psychrolib</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/psychrolib.f90.html#src">psychrolib.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! PsychroLib (version 2.5.0) (https://github.com/psychrometrics/psychrolib).</span>
<a name="ln-2"></a><span class="c">! Copyright (c) 2018-2020 The PsychroLib Contributors for the current library implementation.</span>
<a name="ln-3"></a><span class="c">! Copyright (c) 2017 ASHRAE Handbook — Fundamentals for ASHRAE equations and coefficients.</span>
<a name="ln-4"></a><span class="c">! Licensed under the MIT License.</span>
<a name="ln-5"></a>
<a name="ln-6"></a><span class="k">module </span><span class="n">psychrolib</span>
<a name="ln-7"></a>  <span class="c">!+ Module overview</span>
<a name="ln-8"></a>  <span class="c">!+  Contains functions for calculating thermodynamic properties of gas-vapor mixtures</span>
<a name="ln-9"></a>  <span class="c">!+  and standard atmosphere suitable for most engineering, physical, and meteorological</span>
<a name="ln-10"></a>  <span class="c">!+  applications.</span>
<a name="ln-11"></a>  <span class="c">!+</span>
<a name="ln-12"></a>  <span class="c">!+  Most of the functions are an implementation of the formulae found in the</span>
<a name="ln-13"></a>  <span class="c">!+  2017 ASHRAE Handbook - Fundamentals, in both International System (SI),</span>
<a name="ln-14"></a>  <span class="c">!+  and Imperial (IP) units. Please refer to the information included in</span>
<a name="ln-15"></a>  <span class="c">!+  each function for their respective reference.</span>
<a name="ln-16"></a>  <span class="c">!+</span>
<a name="ln-17"></a>  <span class="c">!+ Example</span>
<a name="ln-18"></a>  <span class="c">!+  use psychrolib, only: GetTDewPointFromRelHum, SetUnitSystem, SI</span>
<a name="ln-19"></a>  <span class="c">!+  ! Set the unit system, for example to SI (can be either &#39;SI&#39; or &#39;IP&#39;)</span>
<a name="ln-20"></a>  <span class="c">!+  call SetUnitSystem(SI)</span>
<a name="ln-21"></a>  <span class="c">!+  ! Calculate the dew point temperature for a dry bulb temperature of 25 C and a relative humidity of 80%</span>
<a name="ln-22"></a>  <span class="c">!+  print *, GetTDewPointFromRelHum(25.0, 0.80)</span>
<a name="ln-23"></a>  <span class="c">!+ 21.3094</span>
<a name="ln-24"></a>  <span class="c">!+</span>
<a name="ln-25"></a>  <span class="c">!+ Copyright</span>
<a name="ln-26"></a>  <span class="c">!+  - For the current library implementation</span>
<a name="ln-27"></a>  <span class="c">!+     Copyright (c) 2018-2020 The PsychroLib Contributors.</span>
<a name="ln-28"></a>  <span class="c">!+  - For equations and coefficients published ASHRAE Handbook — Fundamentals, Chapter 1</span>
<a name="ln-29"></a>  <span class="c">!+     Copyright (c) 2017 ASHRAE Handbook — Fundamentals (https://www.ashrae.org)</span>
<a name="ln-30"></a>  <span class="c">!+</span>
<a name="ln-31"></a>  <span class="c">!+ License</span>
<a name="ln-32"></a>  <span class="c">!+  MIT (https://github.com/psychrometrics/psychrolib/LICENSE.txt)</span>
<a name="ln-33"></a>  <span class="c">!+</span>
<a name="ln-34"></a>  <span class="c">!+ Note from the Authors</span>
<a name="ln-35"></a>  <span class="c">!+  We have made every effort to ensure that the code is adequate, however, we make no</span>
<a name="ln-36"></a>  <span class="c">!+  representation with respect to its accuracy. Use at your own risk. Should you notice</span>
<a name="ln-37"></a>  <span class="c">!+  an error, or if you have a suggestion, please notify us through GitHub at</span>
<a name="ln-38"></a>  <span class="c">!+  https://github.com/psychrometrics/psychrolib/issues.</span>
<a name="ln-39"></a>
<a name="ln-40"></a>
<a name="ln-41"></a>  <span class="k">implicit none</span>
<a name="ln-42"></a>
<a name="ln-43"></a><span class="k">  private</span>
<a name="ln-44"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">IP</span>
<a name="ln-45"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">SI</span>
<a name="ln-46"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">SetUnitSystem</span>
<a name="ln-47"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetUnitSystem</span>
<a name="ln-48"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">isIP</span>
<a name="ln-49"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTRankineFromTFahrenheit</span>
<a name="ln-50"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTFahrenheitFromTRankine</span>
<a name="ln-51"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTKelvinFromTCelsius</span>
<a name="ln-52"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTCelsiusFromTKelvin</span>
<a name="ln-53"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTWetBulbFromTDewPoint</span>
<a name="ln-54"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTWetBulbFromRelHum</span>
<a name="ln-55"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetRelHumFromTDewPoint</span>
<a name="ln-56"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetRelHumFromTWetBulb</span>
<a name="ln-57"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTDewPointFromRelHum</span>
<a name="ln-58"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTDewPointFromTWetBulb</span>
<a name="ln-59"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetVapPresFromRelHum</span>
<a name="ln-60"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetRelHumFromVapPres</span>
<a name="ln-61"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTDewPointFromVapPres</span>
<a name="ln-62"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetVapPresFromTDewPoint</span>
<a name="ln-63"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTWetBulbFromHumRatio</span>
<a name="ln-64"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetHumRatioFromTWetBulb</span>
<a name="ln-65"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetHumRatioFromRelHum</span>
<a name="ln-66"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetRelHumFromHumRatio</span>
<a name="ln-67"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetHumRatioFromTDewPoint</span>
<a name="ln-68"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTDewPointFromHumRatio</span>
<a name="ln-69"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetHumRatioFromVapPres</span>
<a name="ln-70"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetVapPresFromHumRatio</span>
<a name="ln-71"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetDryAirEnthalpy</span>
<a name="ln-72"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetDryAirDensity</span>
<a name="ln-73"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetDryAirVolume</span>
<a name="ln-74"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTDryBulbFromEnthalpyAndHumRatio</span>
<a name="ln-75"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetHumRatioFromEnthalpyAndTDryBulb</span>
<a name="ln-76"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetSatVapPres</span>
<a name="ln-77"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetSatHumRatio</span>
<a name="ln-78"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetSatAirEnthalpy</span>
<a name="ln-79"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetVaporPressureDeficit</span>
<a name="ln-80"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetDegreeOfSaturation</span>
<a name="ln-81"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetMoistAirEnthalpy</span>
<a name="ln-82"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetMoistAirVolume</span>
<a name="ln-83"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetTDryBulbFromMoistAirVolumeAndHumRatio</span>
<a name="ln-84"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetMoistAirDensity</span>
<a name="ln-85"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetStandardAtmPressure</span>
<a name="ln-86"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetStandardAtmTemperature</span>
<a name="ln-87"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetSeaLevelPressure</span>
<a name="ln-88"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetStationPressure</span>
<a name="ln-89"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetSpecificHumFromHumRatio</span>
<a name="ln-90"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">GetHumRatioFromSpecificHum</span>
<a name="ln-91"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">CalcPsychrometricsFromTWetBulb</span>
<a name="ln-92"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">CalcPsychrometricsFromTDewPoint</span>
<a name="ln-93"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">CalcPsychrometricsFromRelHum</span>
<a name="ln-94"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">dLnPws_</span>
<a name="ln-95"></a>
<a name="ln-96"></a>
<a name="ln-97"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-98"></a>  <span class="c">! Global constants</span>
<a name="ln-99"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-100"></a>
<a name="ln-101"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span>  <span class="n">ZERO_FAHRENHEIT_AS_RANKINE</span> <span class="o">=</span> <span class="mi">45</span><span class="mf">9.67</span>
<a name="ln-102"></a>    <span class="c">!+ Zero degree Fahrenheit (°F) expressed as degree Rankine (°R).</span>
<a name="ln-103"></a>    <span class="c">!+ Reference:</span>
<a name="ln-104"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 39.</span>
<a name="ln-105"></a>
<a name="ln-106"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span>  <span class="n">ZERO_CELSIUS_AS_KELVIN</span> <span class="o">=</span> <span class="mi">27</span><span class="mf">3.15</span>
<a name="ln-107"></a>    <span class="c">!+ Zero degree Celsius (°C) expressed as Kelvin (K).</span>
<a name="ln-108"></a>    <span class="c">!+ Reference:</span>
<a name="ln-109"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 39.</span>
<a name="ln-110"></a>
<a name="ln-111"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span>  <span class="n">R_DA_IP</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">3.350</span>
<a name="ln-112"></a>    <span class="c">!+ Universal gas constant for dry air (IP version) in ft lb_Force lb_DryAir⁻¹ R⁻¹.</span>
<a name="ln-113"></a>    <span class="c">!+ Reference:</span>
<a name="ln-114"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1.</span>
<a name="ln-115"></a>
<a name="ln-116"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span>  <span class="n">R_DA_SI</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">7.042</span>
<a name="ln-117"></a>    <span class="c">!+ Universal gas constant for dry air (SI version) in J kg_DryAir⁻¹ K⁻¹.</span>
<a name="ln-118"></a>    <span class="c">!+ Reference:</span>
<a name="ln-119"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1.</span>
<a name="ln-120"></a>
<a name="ln-121"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">IP</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-122"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">SI</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-123"></a>
<a name="ln-124"></a>  <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">PSYCHROLIB_UNITS</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! 0 = undefined.</span>
<a name="ln-125"></a>    <span class="c">!+ Unit system to use.</span>
<a name="ln-126"></a>
<a name="ln-127"></a>  <span class="kt">real</span> <span class="kd">::</span>  <span class="n">PSYCHROLIB_TOLERANCE</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="ln-128"></a>    <span class="c">!+ Tolerance of temperature calculations.</span>
<a name="ln-129"></a>
<a name="ln-130"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>  <span class="kd">::</span> <span class="n">MAX_ITER_COUNT</span> <span class="o">=</span> <span class="mi">100</span>
<a name="ln-131"></a>    <span class="c">!+ Maximum number of iterations before exiting while loops.</span>
<a name="ln-132"></a>
<a name="ln-133"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span>  <span class="kd">::</span> <span class="n">MIN_HUM_RATIO</span> <span class="o">=</span> <span class="mf">1e-7</span>
<a name="ln-134"></a>    <span class="c">!+ Minimum acceptable humidity ratio used/returned by any functions.</span>
<a name="ln-135"></a>    <span class="c">!+ Any value above 0 or below the MIN_HUM_RATIO will be reset to this value.</span>
<a name="ln-136"></a>
<a name="ln-137"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span>  <span class="kd">::</span> <span class="n">FREEZING_POINT_WATER_IP</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">2.0</span>
<a name="ln-138"></a>    <span class="c">!+ float: Freezing point of water in Fahrenheit.</span>
<a name="ln-139"></a>
<a name="ln-140"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span>  <span class="kd">::</span> <span class="n">FREEZING_POINT_WATER_SI</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-141"></a>    <span class="c">!+ float: Freezing point of water in Celsius.</span>
<a name="ln-142"></a>
<a name="ln-143"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span>  <span class="kd">::</span> <span class="n">TRIPLE_POINT_WATER_IP</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">2.018</span>
<a name="ln-144"></a>    <span class="c">!+ float: Triple point of water in Fahrenheit.</span>
<a name="ln-145"></a>
<a name="ln-146"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span>  <span class="kd">::</span> <span class="n">TRIPLE_POINT_WATER_SI</span> <span class="o">=</span> <span class="mf">0.01</span>
<a name="ln-147"></a>    <span class="c">!+ float: Triple point of water in Celsius.</span>
<a name="ln-148"></a>
<a name="ln-149"></a>
<a name="ln-150"></a>  <span class="k">contains</span>
<a name="ln-151"></a>
<a name="ln-152"></a>
<a name="ln-153"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-154"></a>  <span class="c">! Helper functions</span>
<a name="ln-155"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-156"></a>
<a name="ln-157"></a>  <span class="k">subroutine </span><span class="n">SetUnitSystem</span><span class="p">(</span><span class="n">UnitSystem</span><span class="p">)</span>
<a name="ln-158"></a>  <span class="c">!+ Set the system of units to use (SI or IP).</span>
<a name="ln-159"></a>  <span class="c">!+ Notes: this function *HAS TO BE CALLED* before the library can be used</span>
<a name="ln-160"></a>
<a name="ln-161"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitSystem</span>
<a name="ln-162"></a>    <span class="c">!+ Units: string indicating the system of units chosen (SI or IP)</span>
<a name="ln-163"></a>
<a name="ln-164"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="p">(</span><span class="n">UnitSystem</span> <span class="o">==</span> <span class="n">SI</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">UnitSystem</span> <span class="o">==</span> <span class="n">IP</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-165"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;The system of units has to be either SI or IP.&quot;</span>
<a name="ln-166"></a>    <span class="k">end if</span>
<a name="ln-167"></a>
<a name="ln-168"></a><span class="k">    </span><span class="n">PSYCHROLIB_UNITS</span> <span class="o">=</span> <span class="n">UnitSystem</span>
<a name="ln-169"></a>
<a name="ln-170"></a>    <span class="c">! Define tolerance on temperature calculations</span>
<a name="ln-171"></a>    <span class="c">! The tolerance is the same in IP and SI</span>
<a name="ln-172"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">UnitSystem</span> <span class="o">==</span> <span class="n">IP</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-173"></a><span class="k">      </span><span class="n">PSYCHROLIB_TOLERANCE</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="mf">9.0</span> <span class="o">/</span> <span class="mf">5.0</span>
<a name="ln-174"></a>    <span class="k">else</span>
<a name="ln-175"></a><span class="k">      </span><span class="n">PSYCHROLIB_TOLERANCE</span> <span class="o">=</span> <span class="mf">0.001</span>
<a name="ln-176"></a>    <span class="k">end if</span>
<a name="ln-177"></a><span class="k">  end subroutine </span><span class="n">SetUnitSystem</span>
<a name="ln-178"></a>
<a name="ln-179"></a>  <span class="k">function </span><span class="n">GetUnitSystem</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span><span class="n">UnitSystem</span><span class="p">)</span>
<a name="ln-180"></a>    <span class="c">!+ Return the system of units in use.</span>
<a name="ln-181"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">UnitSystem</span>
<a name="ln-182"></a>    <span class="n">UnitSystem</span> <span class="o">=</span> <span class="n">PSYCHROLIB_UNITS</span>
<a name="ln-183"></a>  <span class="k">end function </span><span class="n">GetUnitSystem</span>
<a name="ln-184"></a>
<a name="ln-185"></a>  <span class="k">function </span><span class="n">isIP</span><span class="p">()</span>
<a name="ln-186"></a>    <span class="c">!+ Check whether the system in use is IP or SI</span>
<a name="ln-187"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">isIP</span>
<a name="ln-188"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">PSYCHROLIB_UNITS</span> <span class="o">==</span> <span class="n">IP</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-189"></a><span class="k">      </span><span class="n">isIP</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-190"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">PSYCHROLIB_UNITS</span> <span class="o">==</span> <span class="n">SI</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-191"></a><span class="k">      </span><span class="n">isIP</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-192"></a>    <span class="k">else</span>
<a name="ln-193"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;The system of units has not been defined.&quot;</span>
<a name="ln-194"></a>    <span class="k">end if</span>
<a name="ln-195"></a><span class="k">  end function </span><span class="n">isIP</span>
<a name="ln-196"></a>
<a name="ln-197"></a>
<a name="ln-198"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-199"></a>  <span class="c">! Conversion between temperature units</span>
<a name="ln-200"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-201"></a>
<a name="ln-202"></a>  <span class="k">function </span><span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TFahrenheit</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TRankine</span><span class="p">)</span>
<a name="ln-203"></a>    <span class="c">!+ Utility function to convert temperature to degree Rankine (°R)</span>
<a name="ln-204"></a>    <span class="c">!+ given temperature in degree Fahrenheit (°F).</span>
<a name="ln-205"></a>    <span class="c">!+ Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>
<a name="ln-206"></a>
<a name="ln-207"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TFahrenheit</span>
<a name="ln-208"></a>      <span class="c">!+ Temperature in degree Fahrenheit</span>
<a name="ln-209"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">TRankine</span>
<a name="ln-210"></a>      <span class="c">!+ Temperature in degree Rankine</span>
<a name="ln-211"></a>
<a name="ln-212"></a>    <span class="n">TRankine</span> <span class="o">=</span> <span class="n">TFahrenheit</span> <span class="o">+</span> <span class="n">ZERO_FAHRENHEIT_AS_RANKINE</span>
<a name="ln-213"></a>  <span class="k">end function </span><span class="n">GetTRankineFromTFahrenheit</span>
<a name="ln-214"></a>
<a name="ln-215"></a>  <span class="k">function </span><span class="n">GetTFahrenheitFromTRankine</span><span class="p">(</span><span class="n">TRankine</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TFahrenheit</span><span class="p">)</span>
<a name="ln-216"></a>    <span class="c">!+ Utility function to convert temperature to degree Fahrenheit (°F)</span>
<a name="ln-217"></a>    <span class="c">!+ given temperature in degree Rankine (°R).</span>
<a name="ln-218"></a>    <span class="c">!+ Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>
<a name="ln-219"></a>
<a name="ln-220"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TRankine</span>
<a name="ln-221"></a>      <span class="c">!+ Temperature in degree Rankine</span>
<a name="ln-222"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">TFahrenheit</span>
<a name="ln-223"></a>      <span class="c">!+ Temperature in degree Fahrenheit</span>
<a name="ln-224"></a>
<a name="ln-225"></a>    <span class="n">TFahrenheit</span> <span class="o">=</span> <span class="n">TRankine</span> <span class="o">-</span> <span class="n">ZERO_FAHRENHEIT_AS_RANKINE</span>
<a name="ln-226"></a>  <span class="k">end function </span><span class="n">GetTFahrenheitFromTRankine</span>
<a name="ln-227"></a>
<a name="ln-228"></a>  <span class="k">function </span><span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TCelsius</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TKelvin</span><span class="p">)</span>
<a name="ln-229"></a>    <span class="c">!+ Utility function to convert temperature to Kelvin (K)</span>
<a name="ln-230"></a>    <span class="c">!+ given temperature in degree Celsius (°C).</span>
<a name="ln-231"></a>    <span class="c">!+ Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>
<a name="ln-232"></a>
<a name="ln-233"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TCelsius</span>
<a name="ln-234"></a>      <span class="c">!+ Temperature in degree Celsius</span>
<a name="ln-235"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">TKelvin</span>
<a name="ln-236"></a>      <span class="c">!+ Tempearatyre in Kelvin</span>
<a name="ln-237"></a>
<a name="ln-238"></a>    <span class="n">TKelvin</span> <span class="o">=</span> <span class="n">TCelsius</span> <span class="o">+</span> <span class="n">ZERO_CELSIUS_AS_KELVIN</span>
<a name="ln-239"></a>  <span class="k">end function </span><span class="n">GetTKelvinFromTCelsius</span>
<a name="ln-240"></a>
<a name="ln-241"></a>  <span class="k">function </span><span class="n">GetTCelsiusFromTKelvin</span><span class="p">(</span><span class="n">TKelvin</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TCelsius</span><span class="p">)</span>
<a name="ln-242"></a>    <span class="c">!+ Utility function to convert temperature to degree Celsius (°C)</span>
<a name="ln-243"></a>    <span class="c">!+ given temperature in Kelvin (K).</span>
<a name="ln-244"></a>    <span class="c">!+ Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3</span>
<a name="ln-245"></a>
<a name="ln-246"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TKelvin</span>
<a name="ln-247"></a>      <span class="c">!+ Tempearatyre in Kelvin</span>
<a name="ln-248"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">TCelsius</span>
<a name="ln-249"></a>      <span class="c">!+ Temperature in degree Celsius</span>
<a name="ln-250"></a>
<a name="ln-251"></a>    <span class="n">TCelsius</span> <span class="o">=</span> <span class="n">TKelvin</span> <span class="o">-</span> <span class="n">ZERO_CELSIUS_AS_KELVIN</span>
<a name="ln-252"></a>  <span class="k">end function </span><span class="n">GetTCelsiusFromTKelvin</span>
<a name="ln-253"></a>
<a name="ln-254"></a>
<a name="ln-255"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-256"></a>  <span class="c">! Conversions between dew point, wet bulb, and relative humidity</span>
<a name="ln-257"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-258"></a>
<a name="ln-259"></a>  <span class="k">function </span><span class="n">GetTWetBulbFromTDewPoint</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-260"></a>    <span class="c">!+ Return wet-bulb temperature given dry-bulb temperature, dew-point temperature, and pressure.</span>
<a name="ln-261"></a>    <span class="c">!+ References:</span>
<a name="ln-262"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-263"></a>
<a name="ln-264"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TDryBulb</span>
<a name="ln-265"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-266"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TDewPoint</span>
<a name="ln-267"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-268"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Pressure</span>
<a name="ln-269"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-270"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">TWetBulb</span>
<a name="ln-271"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-272"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">HumRatio</span>
<a name="ln-273"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-274"></a>
<a name="ln-275"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">TDewPoint</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-276"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: dew point temperature is above dry bulb temperature&quot;</span>
<a name="ln-277"></a>    <span class="k">end if</span>
<a name="ln-278"></a>
<a name="ln-279"></a><span class="k">    </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-280"></a>    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-281"></a>  <span class="k">end function </span><span class="n">GetTWetBulbFromTDewPoint</span>
<a name="ln-282"></a>
<a name="ln-283"></a>  <span class="k">function </span><span class="n">GetTWetBulbFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-284"></a>    <span class="c">!+ Return wet-bulb temperature given dry-bulb temperature, relative humidity, and pressure.</span>
<a name="ln-285"></a>    <span class="c">!+ References:</span>
<a name="ln-286"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-287"></a>
<a name="ln-288"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-289"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-290"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-291"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-292"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-293"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-294"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-295"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-296"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-297"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-298"></a>
<a name="ln-299"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-300"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: relative humidity is outside range [0,1]&quot;</span>
<a name="ln-301"></a>    <span class="k">end if</span>
<a name="ln-302"></a>
<a name="ln-303"></a><span class="k">    </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-304"></a>    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-305"></a>  <span class="k">end function </span><span class="n">GetTWetBulbFromRelHum</span>
<a name="ln-306"></a>
<a name="ln-307"></a>  <span class="k">function </span><span class="n">GetRelHumFromTDewPoint</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TDewPoint</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">RelHum</span><span class="p">)</span>
<a name="ln-308"></a>    <span class="c">!+ Return relative humidity given dry-bulb temperature and dew-point temperature.</span>
<a name="ln-309"></a>    <span class="c">!+ References:</span>
<a name="ln-310"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 22</span>
<a name="ln-311"></a>
<a name="ln-312"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-313"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-314"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-315"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-316"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-317"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-318"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-319"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-320"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">SatVapPres</span>
<a name="ln-321"></a>      <span class="c">!+ Vapor pressure of saturated air in Psi [IP] or Pa [SI]</span>
<a name="ln-322"></a>
<a name="ln-323"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">TDewPoint</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-324"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: dew point temperature is above dry bulb temperature&quot;</span>
<a name="ln-325"></a>    <span class="k">end if</span>
<a name="ln-326"></a>
<a name="ln-327"></a><span class="k">    </span><span class="n">VapPres</span>     <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-328"></a>    <span class="n">SatVapPres</span>  <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-329"></a>    <span class="n">RelHum</span>      <span class="o">=</span> <span class="n">VapPres</span> <span class="o">/</span> <span class="n">SatVapPres</span>
<a name="ln-330"></a>  <span class="k">end function </span><span class="n">GetRelHumFromTDewPoint</span>
<a name="ln-331"></a>
<a name="ln-332"></a>  <span class="k">function </span><span class="n">GetRelHumFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">RelHum</span><span class="p">)</span>
<a name="ln-333"></a>    <span class="c">!+ Return relative humidity given dry-bulb temperature, wet bulb temperature and pressure.</span>
<a name="ln-334"></a>    <span class="c">!+ References:</span>
<a name="ln-335"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-336"></a>
<a name="ln-337"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-338"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-339"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-340"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-341"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-342"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-343"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-344"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-345"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-346"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">TWetBulb</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-349"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: wet bulb temperature is above dry bulb temperature&quot;</span>
<a name="ln-350"></a>    <span class="k">end if</span>
<a name="ln-351"></a>
<a name="ln-352"></a><span class="k">    </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-353"></a>    <span class="n">RelHum</span>   <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-354"></a>  <span class="k">end function </span><span class="n">GetRelHumFromTWetBulb</span>
<a name="ln-355"></a>
<a name="ln-356"></a>  <span class="k">function </span><span class="n">GetTDewPointFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-357"></a>    <span class="c">!+ Return dew-point temperature given dry-bulb temperature and relative humidity.</span>
<a name="ln-358"></a>    <span class="c">!+ References:</span>
<a name="ln-359"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-360"></a>
<a name="ln-361"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-362"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-363"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-364"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-365"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-366"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-367"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-368"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-369"></a>
<a name="ln-370"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-371"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: relative humidity is outside range [0,1]&quot;</span>
<a name="ln-372"></a>    <span class="k">end if</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="k">    </span><span class="n">VapPres</span>   <span class="o">=</span> <span class="n">GetVapPresFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">)</span>
<a name="ln-375"></a>    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span>
<a name="ln-376"></a>  <span class="k">end function </span><span class="n">GetTDewPointFromRelHum</span>
<a name="ln-377"></a>
<a name="ln-378"></a>  <span class="k">function </span><span class="n">GetTDewPointFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-379"></a>    <span class="c">!+ Return dew-point temperature given dry-bulb temperature, wet-bulb temperature, and pressure.</span>
<a name="ln-380"></a>    <span class="c">!+ References:</span>
<a name="ln-381"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-382"></a>
<a name="ln-383"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-384"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-385"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-386"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-387"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-388"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-389"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-390"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-391"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-392"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-393"></a>
<a name="ln-394"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">TWetBulb</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-395"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: wet bulb temperature is above dry bulb temperature&quot;</span>
<a name="ln-396"></a>    <span class="k">end if</span>
<a name="ln-397"></a>
<a name="ln-398"></a><span class="k">    </span><span class="n">HumRatio</span>  <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-399"></a>    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-400"></a>  <span class="k">end function </span><span class="n">GetTDewPointFromTWetBulb</span>
<a name="ln-401"></a>
<a name="ln-402"></a>
<a name="ln-403"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-404"></a>  <span class="c">! Conversions between dew point, or relative humidity and vapor pressure</span>
<a name="ln-405"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-406"></a>
<a name="ln-407"></a>  <span class="k">function </span><span class="n">GetVapPresFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">VapPres</span><span class="p">)</span>
<a name="ln-408"></a>    <span class="c">!+ Return partial pressure of water vapor as a function of relative humidity and temperature.</span>
<a name="ln-409"></a>    <span class="c">!+ References:</span>
<a name="ln-410"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 12, 22</span>
<a name="ln-411"></a>
<a name="ln-412"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-413"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-414"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-415"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-416"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-417"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-418"></a>
<a name="ln-419"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-420"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: relative humidity is outside range [0,1]&quot;</span>
<a name="ln-421"></a>    <span class="k">end if</span>
<a name="ln-422"></a>
<a name="ln-423"></a><span class="k">    </span><span class="n">VapPres</span> <span class="o">=</span> <span class="n">RelHum</span> <span class="o">*</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-424"></a>  <span class="k">end function </span><span class="n">GetVapPresFromRelHum</span>
<a name="ln-425"></a>
<a name="ln-426"></a>  <span class="k">function </span><span class="n">GetRelHumFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">RelHum</span><span class="p">)</span>
<a name="ln-427"></a>    <span class="c">!+ Return relative humidity given dry-bulb temperature and vapor pressure.</span>
<a name="ln-428"></a>    <span class="c">!+ References:</span>
<a name="ln-429"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 12, 22</span>
<a name="ln-430"></a>
<a name="ln-431"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-432"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-433"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-434"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-435"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-436"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-437"></a>
<a name="ln-438"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">VapPres</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-439"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: partial pressure of water vapor in moist air cannot be negative&quot;</span>
<a name="ln-440"></a>    <span class="k">end if</span>
<a name="ln-441"></a>
<a name="ln-442"></a><span class="k">    </span><span class="n">RelHum</span> <span class="o">=</span> <span class="n">VapPres</span> <span class="o">/</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-443"></a>  <span class="k">end function </span><span class="n">GetRelHumFromVapPres</span>
<a name="ln-444"></a>
<a name="ln-445"></a>  <span class="k">function </span><span class="n">dLnPws_</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">dLnPws</span><span class="p">)</span>
<a name="ln-446"></a>    <span class="c">!+ Helper function returning the derivative of the natural log of the saturation vapor pressure</span>
<a name="ln-447"></a>    <span class="c">!+ as a function of dry-bulb temperature.</span>
<a name="ln-448"></a>    <span class="c">!+ Reference:</span>
<a name="ln-449"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1  eqn 5</span>
<a name="ln-450"></a>
<a name="ln-451"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-452"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-453"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">dLnPws</span>
<a name="ln-454"></a>      <span class="c">!+ Derivative of natural log of vapor pressure of saturated air in Psi [IP] or Pa [SI]</span>
<a name="ln-455"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">T</span>
<a name="ln-456"></a>      <span class="c">!+ Dry bulb temperature in R [IP] or K [SI]</span>
<a name="ln-457"></a>
<a name="ln-458"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-459"></a>
<a name="ln-460"></a><span class="k">      </span><span class="n">T</span> <span class="o">=</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-461"></a>
<a name="ln-462"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_IP</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-463"></a><span class="k">        </span><span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">1.0214165E+04</span> <span class="o">/</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">5.3765794E-03</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1.9202377E-07</span> <span class="o">*</span> <span class="n">T</span> <span class="p">&amp;</span>
<a name="ln-464"></a>                 <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">3.5575832E-10</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">9.0344688E-14</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">/</span> <span class="n">T</span>
<a name="ln-465"></a>      <span class="k">else</span>
<a name="ln-466"></a><span class="k">        </span><span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">1.0440397E+04</span> <span class="o">/</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">2.7022355E-02</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1.2890360E-05</span> <span class="o">*</span> <span class="n">T</span> <span class="p">&amp;</span>
<a name="ln-467"></a>                 <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">2.4780681E-09</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">/</span> <span class="n">T</span>
<a name="ln-468"></a>      <span class="k">end if</span>
<a name="ln-469"></a>
<a name="ln-470"></a><span class="k">    else</span>
<a name="ln-471"></a>
<a name="ln-472"></a><span class="k">      </span><span class="n">T</span> <span class="o">=</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-473"></a>
<a name="ln-474"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_SI</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-475"></a><span class="k">        </span><span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">5.6745359E+03</span> <span class="o">/</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">9.677843E-03</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">6.2215701E-07</span> <span class="o">*</span> <span class="n">T</span> <span class="p">&amp;</span>
<a name="ln-476"></a>                 <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">2.0747825E-09</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">9.484024E-13</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">/</span> <span class="n">T</span>
<a name="ln-477"></a>      <span class="k">else</span>
<a name="ln-478"></a><span class="k">        </span><span class="n">dLnPws</span> <span class="o">=</span> <span class="mf">5.8002206E+03</span> <span class="o">/</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">4.8640239E-02</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">4.1764768E-05</span> <span class="o">*</span> <span class="n">T</span> <span class="p">&amp;</span>
<a name="ln-479"></a>                 <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">1.4452093E-08</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">/</span> <span class="n">T</span>
<a name="ln-480"></a>      <span class="k">end if</span>
<a name="ln-481"></a><span class="k">    end if</span>
<a name="ln-482"></a><span class="k">  end function </span><span class="n">dLnPws_</span>
<a name="ln-483"></a>
<a name="ln-484"></a>  <span class="k">function </span><span class="n">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-485"></a>    <span class="c">!+ Return dew-point temperature given dry-bulb temperature and vapor pressure.</span>
<a name="ln-486"></a>    <span class="c">!+ References:</span>
<a name="ln-487"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 and 6</span>
<a name="ln-488"></a>    <span class="c">!+ Notes:</span>
<a name="ln-489"></a>    <span class="c">!+ The dew point temperature is solved by inverting the equation giving water vapor pressure</span>
<a name="ln-490"></a>    <span class="c">!+ at saturation from temperature rather than using the regressions provided</span>
<a name="ln-491"></a>    <span class="c">!+ by ASHRAE (eqn. 37 and 38) which are much less accurate and have a</span>
<a name="ln-492"></a>    <span class="c">!+ narrower range of validity.</span>
<a name="ln-493"></a>    <span class="c">!+ The Newton-Raphson (NR) method is used on the logarithm of water vapour</span>
<a name="ln-494"></a>    <span class="c">!+ pressure as a function of temperature, which is a very smooth function</span>
<a name="ln-495"></a>    <span class="c">!+ Convergence is usually achieved in 3 to 5 iterations.</span>
<a name="ln-496"></a>    <span class="c">!+ TDryBulb is not really needed here, just used for convenience.</span>
<a name="ln-497"></a>
<a name="ln-498"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-499"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-500"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-501"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-502"></a>    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-503"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-504"></a>    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">lnVP</span>
<a name="ln-505"></a>      <span class="c">!+ Natural logarithm of partial pressure of water vapor pressure in moist air</span>
<a name="ln-506"></a>    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">d_lnVP</span>
<a name="ln-507"></a>      <span class="c">!+ Derivative of function, calculated numerically</span>
<a name="ln-508"></a>    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">lnVP_iter</span>
<a name="ln-509"></a>      <span class="c">!+ Value of log of vapor water pressure used in NR calculation</span>
<a name="ln-510"></a>    <span class="kt">real</span>                <span class="kd">::</span>  <span class="n">TDewPoint_iter</span>
<a name="ln-511"></a>      <span class="c">!+ Value of TDewPoint used in NR calculation</span>
<a name="ln-512"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">BOUNDS</span>
<a name="ln-513"></a>      <span class="c">!+ Valid temperature range in °F [IP] or °C [SI]</span>
<a name="ln-514"></a>    <span class="kt">integer</span>             <span class="kd">::</span> <span class="nb">index</span>
<a name="ln-515"></a>      <span class="c">!+ Index used in the calculation</span>
<a name="ln-516"></a>
<a name="ln-517"></a>    <span class="c">! Bounds and step size as a function of the system of units</span>
<a name="ln-518"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-519"></a><span class="k">        </span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span><span class="mf">8.0</span>
<a name="ln-520"></a>        <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">39</span><span class="mf">2.0</span>
<a name="ln-521"></a>    <span class="k">else</span>
<a name="ln-522"></a><span class="k">        </span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="mf">0.0</span>
<a name="ln-523"></a>        <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">20</span><span class="mf">0.0</span>
<a name="ln-524"></a>    <span class="k">end if</span>
<a name="ln-525"></a>
<a name="ln-526"></a>    <span class="c">! Validity check -- bounds outside which a solution cannot be found</span>
<a name="ln-527"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">VapPres</span> <span class="o">&lt;</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">VapPres</span> <span class="o">&gt;</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-528"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: partial pressure of water vapor is outside range of validity of equations&quot;</span>
<a name="ln-529"></a>    <span class="k">end if</span>
<a name="ln-530"></a>
<a name="ln-531"></a>    <span class="c">! We use NR to approximate the solution.</span>
<a name="ln-532"></a>    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">TDryBulb</span>
<a name="ln-533"></a>    <span class="n">lnVP</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">VapPres</span><span class="p">)</span>
<a name="ln-534"></a>    <span class="nb">index</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-535"></a>
<a name="ln-536"></a>    <span class="k">do while</span> <span class="p">(.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-537"></a>      <span class="n">TDewPoint_iter</span> <span class="o">=</span> <span class="n">TDewPoint</span> <span class="c">! TDewPoint_iter used in NR calculation</span>
<a name="ln-538"></a>      <span class="n">lnVP_iter</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint_iter</span><span class="p">))</span>
<a name="ln-539"></a>
<a name="ln-540"></a>      <span class="c">! Derivative of function, calculated analytically</span>
<a name="ln-541"></a>      <span class="n">d_lnVP</span> <span class="o">=</span> <span class="n">dLnPws_</span><span class="p">(</span><span class="n">TDewPoint_iter</span><span class="p">)</span>
<a name="ln-542"></a>
<a name="ln-543"></a>      <span class="c">! New estimate, bounded by the search domain defined above</span>
<a name="ln-544"></a>      <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">TDewPoint_iter</span> <span class="o">-</span> <span class="p">(</span><span class="n">lnVP_iter</span> <span class="o">-</span> <span class="n">lnVP</span><span class="p">)</span> <span class="o">/</span> <span class="n">d_lnVP</span>
<a name="ln-545"></a>      <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-546"></a>      <span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">BOUNDS</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-547"></a>
<a name="ln-548"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">TDewPoint</span> <span class="o">-</span> <span class="n">TDewPoint_iter</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">PSYCHROLIB_TOLERANCE</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-549"></a><span class="k">        exit</span>
<a name="ln-550"></a><span class="k">      end if</span>
<a name="ln-551"></a>
<a name="ln-552"></a><span class="k">      if</span> <span class="p">(</span><span class="nb">index</span> <span class="o">&gt;</span> <span class="n">MAX_ITER_COUNT</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-553"></a><span class="k">        </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Convergence not reached in GetTDewPointFromVapPres. Stopping.&quot;</span>
<a name="ln-554"></a>      <span class="k">end if</span>
<a name="ln-555"></a>
<a name="ln-556"></a><span class="k">      </span><span class="nb">index</span> <span class="o">=</span> <span class="nb">index</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-557"></a>    <span class="k">end do</span>
<a name="ln-558"></a>
<a name="ln-559"></a><span class="k">  </span><span class="n">TDewPoint</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-560"></a>  <span class="k">end function </span><span class="n">GetTDewPointFromVapPres</span>
<a name="ln-561"></a>
<a name="ln-562"></a>  <span class="k">function </span><span class="n">GetVapPresFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">VapPres</span><span class="p">)</span>
<a name="ln-563"></a>    <span class="c">!+ Return vapor pressure given dew point temperature.</span>
<a name="ln-564"></a>    <span class="c">!+ References:</span>
<a name="ln-565"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 36</span>
<a name="ln-566"></a>
<a name="ln-567"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-568"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-569"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-570"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-571"></a>
<a name="ln-572"></a>    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-573"></a>  <span class="k">end function </span><span class="n">GetVapPresFromTDewPoint</span>
<a name="ln-574"></a>
<a name="ln-575"></a>
<a name="ln-576"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-577"></a>  <span class="c">! Conversions from wet-bulb temperature, dew-point temperature, or relative humidity to humidity ratio</span>
<a name="ln-578"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-579"></a>
<a name="ln-580"></a>  <span class="k">function </span><span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-581"></a>    <span class="c">!+ Return wet-bulb temperature given dry-bulb temperature, humidity ratio, and pressure.</span>
<a name="ln-582"></a>    <span class="c">!+ References:</span>
<a name="ln-583"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 33 and 35 solved for Tstar</span>
<a name="ln-584"></a>
<a name="ln-585"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-586"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-587"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-588"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-589"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-590"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-591"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-592"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-593"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-594"></a>      <span class="c">!+ TDewPoint : Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-595"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TWetBulbSup</span>
<a name="ln-596"></a>      <span class="c">!+ Upper value of wet bulb temperature in bissection method (initial guess is from dry bulb temperature) in °F [IP] or °C [SI]</span>
<a name="ln-597"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TWetBulbInf</span>
<a name="ln-598"></a>      <span class="c">!+ Lower value of wet bulb temperature in bissection method (initial guess is from dew point temperature) in °F [IP] or °C [SI]</span>
<a name="ln-599"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">Wstar</span>
<a name="ln-600"></a>      <span class="c">!+ Humidity ratio at temperature Tstar in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-601"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-602"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-603"></a>    <span class="kt">integer</span>           <span class="kd">::</span>  <span class="nb">index</span>
<a name="ln-604"></a>      <span class="c">!+ index used in iteration</span>
<a name="ln-605"></a>
<a name="ln-606"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-607"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio cannot be negative&quot;</span>
<a name="ln-608"></a>    <span class="k">end if</span>
<a name="ln-609"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-610"></a>
<a name="ln-611"></a>    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">BoundedHumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-612"></a>
<a name="ln-613"></a>    <span class="c">! Initial guesses</span>
<a name="ln-614"></a>    <span class="n">TWetBulbSup</span> <span class="o">=</span> <span class="n">TDryBulb</span>
<a name="ln-615"></a>    <span class="n">TWetBulbInf</span> <span class="o">=</span> <span class="n">TDewPoint</span>
<a name="ln-616"></a>    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="p">(</span><span class="n">TWetBulbInf</span> <span class="o">+</span> <span class="n">TWetBulbSup</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
<a name="ln-617"></a>
<a name="ln-618"></a>    <span class="nb">index</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-619"></a>    <span class="c">! Bisection loop</span>
<a name="ln-620"></a>    <span class="k">do while</span> <span class="p">((</span><span class="n">TWetBulbSup</span> <span class="o">-</span> <span class="n">TWetBulbInf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">PSYCHROLIB_TOLERANCE</span><span class="p">)</span>
<a name="ln-621"></a>
<a name="ln-622"></a>    <span class="c">! Compute humidity ratio at temperature Tstar</span>
<a name="ln-623"></a>    <span class="n">Wstar</span> <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a>    <span class="c">! Get new bounds</span>
<a name="ln-626"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Wstar</span> <span class="o">&gt;</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-627"></a><span class="k">      </span><span class="n">TWetBulbSup</span> <span class="o">=</span> <span class="n">TWetBulb</span>
<a name="ln-628"></a>    <span class="k">else</span>
<a name="ln-629"></a><span class="k">      </span><span class="n">TWetBulbInf</span> <span class="o">=</span> <span class="n">TWetBulb</span>
<a name="ln-630"></a>    <span class="k">end if</span>
<a name="ln-631"></a>
<a name="ln-632"></a>    <span class="c">! New guess of wet bulb temperature</span>
<a name="ln-633"></a>    <span class="n">TWetBulb</span> <span class="o">=</span> <span class="p">(</span><span class="n">TWetBulbSup</span> <span class="o">+</span> <span class="n">TWetBulbInf</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
<a name="ln-634"></a>
<a name="ln-635"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">index</span> <span class="o">&gt;</span> <span class="n">MAX_ITER_COUNT</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-636"></a><span class="k">        </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Convergence not reached in GetTWetBulbFromHumRatio. Stopping.&quot;</span>
<a name="ln-637"></a>      <span class="k">end if</span>
<a name="ln-638"></a>
<a name="ln-639"></a><span class="k">    </span><span class="nb">index</span> <span class="o">=</span> <span class="nb">index</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-640"></a>    <span class="k">end do</span>
<a name="ln-641"></a><span class="k">  end function </span><span class="n">GetTWetBulbFromHumRatio</span>
<a name="ln-642"></a>
<a name="ln-643"></a>  <span class="k">function </span><span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-644"></a>    <span class="c">!+ Return humidity ratio given dry-bulb temperature, wet-bulb temperature, and pressure.</span>
<a name="ln-645"></a>    <span class="c">!+ References:</span>
<a name="ln-646"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 33 and 35</span>
<a name="ln-647"></a>
<a name="ln-648"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-649"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-650"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-651"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-652"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-653"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-654"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-655"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-656"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">Wsstar</span>
<a name="ln-657"></a>      <span class="c">!+ Humidity ratio at temperature Tstar in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-658"></a>
<a name="ln-659"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">TWetBulb</span> <span class="o">&gt;</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-660"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: wet bulb temperature is above dry bulb temperature&quot;</span>
<a name="ln-661"></a>    <span class="k">end if</span>
<a name="ln-662"></a>
<a name="ln-663"></a><span class="k">    </span><span class="n">Wsstar</span> <span class="o">=</span> <span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-664"></a>
<a name="ln-665"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-666"></a><span class="k">      if</span> <span class="p">(</span><span class="n">TWetBulb</span> <span class="o">&gt;=</span> <span class="n">FREEZING_POINT_WATER_IP</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-667"></a><span class="k">        </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mi">109</span><span class="mf">3.0</span> <span class="o">-</span> <span class="mf">0.556</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span>   <span class="p">&amp;</span>
<a name="ln-668"></a>                   <span class="o">/</span> <span class="p">(</span><span class="mi">109</span><span class="mf">3.0</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-669"></a>      <span class="k">else</span>
<a name="ln-670"></a><span class="k">        </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mi">122</span><span class="mf">0.0</span> <span class="o">-</span> <span class="mf">0.04</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span>    <span class="p">&amp;</span>
<a name="ln-671"></a>                   <span class="o">/</span> <span class="p">(</span><span class="mi">122</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="mf">0.48</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-672"></a>      <span class="k">end if</span>
<a name="ln-673"></a><span class="k">    else</span>
<a name="ln-674"></a><span class="k">      if</span> <span class="p">(</span><span class="n">TWetBulb</span> <span class="o">&gt;=</span> <span class="n">FREEZING_POINT_WATER_SI</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-675"></a><span class="k">        </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mi">250</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.326</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">1.006</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span>   <span class="p">&amp;</span>
<a name="ln-676"></a>                   <span class="o">/</span> <span class="p">(</span><span class="mi">250</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="mf">4.186</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-677"></a>      <span class="k">else</span>
<a name="ln-678"></a><span class="k">           </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="p">((</span><span class="mi">283</span><span class="mf">0.0</span> <span class="o">-</span> <span class="mf">0.24</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">Wsstar</span> <span class="o">-</span> <span class="mf">1.006</span> <span class="o">*</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">-</span> <span class="n">TWetBulb</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-679"></a>                      <span class="o">/</span> <span class="p">(</span><span class="mi">283</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">-</span> <span class="mf">2.1</span> <span class="o">*</span> <span class="n">TWetBulb</span><span class="p">)</span>
<a name="ln-680"></a>      <span class="k">end if</span>
<a name="ln-681"></a><span class="k">    end if</span>
<a name="ln-682"></a>
<a name="ln-683"></a>    <span class="c">! Validity check.</span>
<a name="ln-684"></a>    <span class="n">HumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-685"></a>  <span class="k">end function </span><span class="n">GetHumRatioFromTWetBulb</span>
<a name="ln-686"></a>
<a name="ln-687"></a>  <span class="k">function </span><span class="n">GetHumRatioFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-688"></a>    <span class="c">!+ Return humidity ratio given dry-bulb temperature, relative humidity, and pressure.</span>
<a name="ln-689"></a>    <span class="c">!+ Reference:</span>
<a name="ln-690"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-691"></a>
<a name="ln-692"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-693"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-694"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-695"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-696"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-697"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-698"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-699"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-700"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-701"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-702"></a>
<a name="ln-703"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">RelHum</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RelHum</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-704"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: relative humidity is outside range [0,1]&quot;</span>
<a name="ln-705"></a>    <span class="k">end if</span>
<a name="ln-706"></a>
<a name="ln-707"></a><span class="k">    </span><span class="n">VapPres</span>   <span class="o">=</span> <span class="n">GetVapPresFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">)</span>
<a name="ln-708"></a>    <span class="n">HumRatio</span>  <span class="o">=</span> <span class="n">GetHumRatioFromVapPres</span><span class="p">(</span><span class="n">VapPres</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-709"></a>  <span class="k">end function </span><span class="n">GetHumRatioFromRelHum</span>
<a name="ln-710"></a>
<a name="ln-711"></a>  <span class="k">function </span><span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">RelHum</span><span class="p">)</span>
<a name="ln-712"></a>  <span class="c">!+ Return relative humidity given dry-bulb temperature, humidity ratio, and pressure.</span>
<a name="ln-713"></a>  <span class="c">!+ Reference:</span>
<a name="ln-714"></a>  <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-715"></a>
<a name="ln-716"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-717"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-718"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-719"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-720"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-721"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-722"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-723"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-724"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-725"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-726"></a>
<a name="ln-727"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-728"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio cannot be negative&quot;</span>
<a name="ln-729"></a>    <span class="k">end if</span>
<a name="ln-730"></a>
<a name="ln-731"></a><span class="k">    </span><span class="n">VapPres</span> <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-732"></a>    <span class="n">RelHum</span>  <span class="o">=</span> <span class="n">GetRelHumFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span>
<a name="ln-733"></a>  <span class="k">end function </span><span class="n">GetRelHumFromHumRatio</span>
<a name="ln-734"></a>
<a name="ln-735"></a>  <span class="k">function </span><span class="n">GetHumRatioFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-736"></a>    <span class="c">!+ Return humidity ratio given dew-point temperature and pressure.</span>
<a name="ln-737"></a>    <span class="c">!+ Reference:</span>
<a name="ln-738"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-739"></a>
<a name="ln-740"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-741"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-742"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-743"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-744"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-745"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-746"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-747"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-748"></a>
<a name="ln-749"></a>    <span class="n">VapPres</span>   <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-750"></a>    <span class="n">HumRatio</span>  <span class="o">=</span> <span class="n">GetHumRatioFromVapPres</span><span class="p">(</span><span class="n">VapPres</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-751"></a>  <span class="k">end function </span><span class="n">GetHumRatioFromTDewPoint</span>
<a name="ln-752"></a>
<a name="ln-753"></a>  <span class="k">function </span><span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">)</span>
<a name="ln-754"></a>    <span class="c">!+ Return dew-point temperature given dry-bulb temperature, humidity ratio, and pressure.</span>
<a name="ln-755"></a>    <span class="c">!+ Reference:</span>
<a name="ln-756"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-757"></a>
<a name="ln-758"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-759"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-760"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-761"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-762"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-763"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-764"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-765"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-766"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-767"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-768"></a>
<a name="ln-769"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-770"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio cannot be negative&quot;</span>
<a name="ln-771"></a>    <span class="k">end if</span>
<a name="ln-772"></a>
<a name="ln-773"></a><span class="k">    </span><span class="n">VapPres</span>   <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-774"></a>    <span class="n">TDewPoint</span> <span class="o">=</span> <span class="n">GetTDewPointFromVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">VapPres</span><span class="p">)</span>
<a name="ln-775"></a>  <span class="k">end function </span><span class="n">GetTDewPointFromHumRatio</span>
<a name="ln-776"></a>
<a name="ln-777"></a>
<a name="ln-778"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-779"></a>  <span class="c">! Conversions between humidity ratio and vapor pressure</span>
<a name="ln-780"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-781"></a>
<a name="ln-782"></a>  <span class="k">function </span><span class="n">GetHumRatioFromVapPres</span><span class="p">(</span><span class="n">VapPres</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-783"></a>    <span class="c">!+ Return humidity ratio given water vapor pressure and atmospheric pressure.</span>
<a name="ln-784"></a>    <span class="c">!+ Reference:</span>
<a name="ln-785"></a>    <span class="c">!+ ASHRAE Fundamentals (2005) ch. 6 eqn. 22;</span>
<a name="ln-786"></a>    <span class="c">!+ ASHRAE Fundamentals (2009) ch. 1 eqn. 22.</span>
<a name="ln-787"></a>
<a name="ln-788"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-789"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-790"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-791"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-792"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-793"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-794"></a>
<a name="ln-795"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">VapPres</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-796"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: partial pressure of water vapor in moist air cannot be negative&quot;</span>
<a name="ln-797"></a>    <span class="k">end if</span>
<a name="ln-798"></a>
<a name="ln-799"></a><span class="k">    </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="mf">0.621945</span> <span class="o">*</span> <span class="n">VapPres</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pressure</span><span class="o">-</span><span class="n">VapPres</span><span class="p">)</span>
<a name="ln-800"></a>
<a name="ln-801"></a>    <span class="c">! Validity check.</span>
<a name="ln-802"></a>    <span class="n">HumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-803"></a>  <span class="k">end function </span><span class="n">GetHumRatioFromVapPres</span>
<a name="ln-804"></a>
<a name="ln-805"></a>  <span class="k">function </span><span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">VapPres</span><span class="p">)</span>
<a name="ln-806"></a>    <span class="c">!+ Return vapor pressure given humidity ratio and pressure.</span>
<a name="ln-807"></a>    <span class="c">!+ Reference:</span>
<a name="ln-808"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 20 solved for pw</span>
<a name="ln-809"></a>
<a name="ln-810"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-811"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-812"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-813"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-814"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-815"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-816"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-817"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-818"></a>
<a name="ln-819"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-820"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-821"></a>    <span class="k">end if</span>
<a name="ln-822"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-823"></a>
<a name="ln-824"></a>    <span class="n">VapPres</span> <span class="o">=</span> <span class="n">Pressure</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.621945</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
<a name="ln-825"></a>  <span class="k">end function </span><span class="n">GetVapPresFromHumRatio</span>
<a name="ln-826"></a>
<a name="ln-827"></a>
<a name="ln-828"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-829"></a>  <span class="c">! Conversions between humidity ratio and specific humidity</span>
<a name="ln-830"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-831"></a>
<a name="ln-832"></a>  <span class="k">function </span><span class="n">GetSpecificHumFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">SpecificHum</span><span class="p">)</span>
<a name="ln-833"></a>    <span class="c">!+ Return the specific humidity from humidity ratio (aka mixing ratio).</span>
<a name="ln-834"></a>    <span class="c">!+ Reference:</span>
<a name="ln-835"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 9b</span>
<a name="ln-836"></a>
<a name="ln-837"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HumRatio</span>
<a name="ln-838"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Dry_Air⁻¹ [IP] or kg_H₂O kg_Dry_Air⁻¹ [SI]</span>
<a name="ln-839"></a>    <span class="kt">real</span>             <span class="kd">::</span> <span class="n">SpecificHum</span>
<a name="ln-840"></a>      <span class="c">!+ Specific humidity in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-841"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-842"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-843"></a>
<a name="ln-844"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-845"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio cannot be negative&quot;</span>
<a name="ln-846"></a>    <span class="k">end if</span>
<a name="ln-847"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-848"></a>
<a name="ln-849"></a>    <span class="n">SpecificHum</span> <span class="o">=</span> <span class="n">BoundedHumRatio</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
<a name="ln-850"></a>  <span class="k">end function </span><span class="n">GetSpecificHumFromHumRatio</span>
<a name="ln-851"></a>
<a name="ln-852"></a>  <span class="k">function </span><span class="n">GetHumRatioFromSpecificHum</span><span class="p">(</span><span class="n">SpecificHum</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-853"></a>    <span class="c">!+ Return the humidity ratio (aka mixing ratio) from specific humidity.</span>
<a name="ln-854"></a>    <span class="c">!+ Reference:</span>
<a name="ln-855"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 9b (solved for humidity ratio)</span>
<a name="ln-856"></a>
<a name="ln-857"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpecificHum</span>
<a name="ln-858"></a>      <span class="c">!+ Specific humidity in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-859"></a>    <span class="kt">real</span>              <span class="kd">::</span> <span class="n">HumRatio</span>
<a name="ln-860"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Dry_Air⁻¹ [IP] or kg_H₂O kg_Dry_Air⁻¹ [SI]</span>
<a name="ln-861"></a>
<a name="ln-862"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">SpecificHum</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SpecificHum</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-863"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: specific humidity is outside range [0, 1)&quot;</span>
<a name="ln-864"></a>    <span class="k">end if</span>
<a name="ln-865"></a>
<a name="ln-866"></a><span class="k">    </span><span class="n">HumRatio</span> <span class="o">=</span> <span class="n">SpecificHum</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">SpecificHum</span><span class="p">)</span>
<a name="ln-867"></a>
<a name="ln-868"></a>    <span class="c">! Validity check.</span>
<a name="ln-869"></a>    <span class="n">HumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-870"></a>  <span class="k">end function </span><span class="n">GetHumRatioFromSpecificHum</span>
<a name="ln-871"></a>
<a name="ln-872"></a>
<a name="ln-873"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-874"></a>  <span class="c">! Dry Air Calculations</span>
<a name="ln-875"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-876"></a>
<a name="ln-877"></a>  <span class="k">function </span><span class="n">GetDryAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">DryAirEnthalpy</span><span class="p">)</span>
<a name="ln-878"></a>    <span class="c">!+ Return dry-air enthalpy given dry-bulb temperature.</span>
<a name="ln-879"></a>    <span class="c">!+ Reference:</span>
<a name="ln-880"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 28</span>
<a name="ln-881"></a>
<a name="ln-882"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-883"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-884"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">DryAirEnthalpy</span>
<a name="ln-885"></a>      <span class="c">!+ Dry air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<a name="ln-886"></a>
<a name="ln-887"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-888"></a><span class="k">      </span><span class="n">DryAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="n">TDryBulb</span>
<a name="ln-889"></a>    <span class="k">else</span>
<a name="ln-890"></a><span class="k">      </span><span class="n">DryAirEnthalpy</span> <span class="o">=</span> <span class="mi">1006</span> <span class="o">*</span> <span class="n">TDryBulb</span>
<a name="ln-891"></a>    <span class="k">end if</span>
<a name="ln-892"></a><span class="k">  end function </span><span class="n">GetDryAirEnthalpy</span>
<a name="ln-893"></a>
<a name="ln-894"></a>  <span class="k">function </span><span class="n">GetDryAirDensity</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">DryAirDensity</span><span class="p">)</span>
<a name="ln-895"></a>    <span class="c">!+ Return dry-air density given dry-bulb temperature and pressure.</span>
<a name="ln-896"></a>    <span class="c">!+ Reference:</span>
<a name="ln-897"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-898"></a>    <span class="c">!+ Notes:</span>
<a name="ln-899"></a>    <span class="c">!+ Eqn 14 for the perfect gas relationship for dry air.</span>
<a name="ln-900"></a>    <span class="c">!+ Eqn 1 for the universal gas constant.</span>
<a name="ln-901"></a>    <span class="c">!+ The factor 144 in IP is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>
<a name="ln-902"></a>
<a name="ln-903"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-904"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-905"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-906"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-907"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">DryAirDensity</span>
<a name="ln-908"></a>      <span class="c">!+ Dry air density in lb ft⁻³ [IP] or kg m⁻³ [SI]</span>
<a name="ln-909"></a>
<a name="ln-910"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-911"></a><span class="k">      </span><span class="n">DryAirDensity</span> <span class="o">=</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span> <span class="o">/</span> <span class="n">R_DA_IP</span> <span class="o">/</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-912"></a>    <span class="k">else</span>
<a name="ln-913"></a><span class="k">      </span><span class="n">DryAirDensity</span> <span class="o">=</span> <span class="n">Pressure</span> <span class="o">/</span> <span class="n">R_DA_SI</span> <span class="o">/</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-914"></a>    <span class="k">end if</span>
<a name="ln-915"></a><span class="k">  end function </span><span class="n">GetDryAirDensity</span>
<a name="ln-916"></a>
<a name="ln-917"></a>  <span class="k">function </span><span class="n">GetDryAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">DryAirVolume</span><span class="p">)</span>
<a name="ln-918"></a>    <span class="c">!+ Return dry-air volume given dry-bulb temperature and pressure.</span>
<a name="ln-919"></a>    <span class="c">!+ Reference:</span>
<a name="ln-920"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-921"></a>    <span class="c">!+ Notes:</span>
<a name="ln-922"></a>    <span class="c">!+ Eqn 14 for the perfect gas relationship for dry air.</span>
<a name="ln-923"></a>    <span class="c">!+ Eqn 1 for the universal gas constant.</span>
<a name="ln-924"></a>    <span class="c">!+ The factor 144 in IP is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>
<a name="ln-925"></a>
<a name="ln-926"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-927"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-928"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-929"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-930"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">DryAirVolume</span>
<a name="ln-931"></a>      <span class="c">!+ Dry air volume in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<a name="ln-932"></a>
<a name="ln-933"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-934"></a><span class="k">      </span><span class="n">DryAirVolume</span> <span class="o">=</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">R_DA_IP</span> <span class="o">/</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-935"></a>    <span class="k">else</span>
<a name="ln-936"></a><span class="k">      </span><span class="n">DryAirVolume</span> <span class="o">=</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="n">R_DA_SI</span> <span class="o">/</span> <span class="n">Pressure</span>
<a name="ln-937"></a>    <span class="k">end if</span>
<a name="ln-938"></a><span class="k">  end function </span><span class="n">GetDryAirVolume</span>
<a name="ln-939"></a>
<a name="ln-940"></a>  <span class="k">function </span><span class="n">GetTDryBulbFromEnthalpyAndHumRatio</span><span class="p">(</span><span class="n">MoistAirEnthalpy</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-941"></a>    <span class="c">!+ Return dry bulb temperature from enthalpy and humidity ratio.</span>
<a name="ln-942"></a>    <span class="c">!+ Reference:</span>
<a name="ln-943"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30</span>
<a name="ln-944"></a>    <span class="c">!+ Notes:</span>
<a name="ln-945"></a>    <span class="c">!+ Based on the `GetMoistAirEnthalpy` function, rearranged for temperature.</span>
<a name="ln-946"></a>
<a name="ln-947"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">MoistAirEnthalpy</span>
<a name="ln-948"></a>      <span class="c">!+ Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹</span>
<a name="ln-949"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-950"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-951"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-952"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-953"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-954"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-955"></a>
<a name="ln-956"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-957"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-958"></a>    <span class="k">end if</span>
<a name="ln-959"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-960"></a>
<a name="ln-961"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-962"></a><span class="k">      </span><span class="n">TDryBulb</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">-</span> <span class="mi">106</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.240</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
<a name="ln-963"></a>    <span class="k">else</span>
<a name="ln-964"></a><span class="k">      </span><span class="n">TDryBulb</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0</span> <span class="o">-</span> <span class="mi">250</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.006</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span>
<a name="ln-965"></a>    <span class="k">end if</span>
<a name="ln-966"></a><span class="k">  end function </span><span class="n">GetTDryBulbFromEnthalpyAndHumRatio</span>
<a name="ln-967"></a>
<a name="ln-968"></a>  <span class="k">function </span><span class="n">GetHumRatioFromEnthalpyAndTDryBulb</span><span class="p">(</span><span class="n">MoistAirEnthalpy</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-969"></a>    <span class="c">!+ Return humidity ratio from enthalpy and dry-bulb temperature.</span>
<a name="ln-970"></a>    <span class="c">!+ Reference:</span>
<a name="ln-971"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30</span>
<a name="ln-972"></a>    <span class="c">!+ Notes:</span>
<a name="ln-973"></a>    <span class="c">!+ Based on the `GetMoistAirEnthalpy` function, rearranged for humidity ratio.</span>
<a name="ln-974"></a>
<a name="ln-975"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">MoistAirEnthalpy</span>
<a name="ln-976"></a>      <span class="c">!+ Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹</span>
<a name="ln-977"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-978"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-979"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-980"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-981"></a>
<a name="ln-982"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-983"></a><span class="k">      </span><span class="n">HumRatio</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">-</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">106</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-984"></a>    <span class="k">else</span>
<a name="ln-985"></a><span class="k">      </span><span class="n">HumRatio</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MoistAirEnthalpy</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0</span> <span class="o">-</span> <span class="mf">1.006</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">250</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-986"></a>    <span class="k">end if</span>
<a name="ln-987"></a>
<a name="ln-988"></a>    <span class="c">! Validity check.</span>
<a name="ln-989"></a>    <span class="n">HumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-990"></a>  <span class="k">end function </span><span class="n">GetHumRatioFromEnthalpyAndTDryBulb</span>
<a name="ln-991"></a>
<a name="ln-992"></a>
<a name="ln-993"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-994"></a>  <span class="c">! Saturated Air Calculations</span>
<a name="ln-995"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-996"></a>
<a name="ln-997"></a>  <span class="k">function </span><span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">SatVapPres</span><span class="p">)</span>
<a name="ln-998"></a>    <span class="c">!+ Return saturation vapor pressure given dry-bulb temperature.</span>
<a name="ln-999"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1000"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1  eqn 5</span>
<a name="ln-1001"></a>    <span class="c">!+ Important note: the ASHRAE formulae are defined above and below the freezing point but have</span>
<a name="ln-1002"></a>    <span class="c">!+ a discontinuity at the freezing point. This is a small inaccuracy on ASHRAE&#39;s part: the formulae</span>
<a name="ln-1003"></a>    <span class="c">!+ should be defined above and below the triple point of water (not the feezing point) in which case </span>
<a name="ln-1004"></a>    <span class="c">!+ the discontinuity vanishes. It is essential to use the triple point of water otherwise function</span>
<a name="ln-1005"></a>    <span class="c">!+ GetTDewPointFromVapPres, which inverts the present function, does not converge properly around</span>
<a name="ln-1006"></a>    <span class="c">!+ the freezing point.</span>
<a name="ln-1007"></a>
<a name="ln-1008"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1009"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1010"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">SatVapPres</span>
<a name="ln-1011"></a>      <span class="c">!+ Vapor pressure of saturated air in Psi [IP] or Pa [SI]</span>
<a name="ln-1012"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">LnPws</span>
<a name="ln-1013"></a>      <span class="c">!+ Log of Vapor Pressure of saturated air (dimensionless)</span>
<a name="ln-1014"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">T</span>
<a name="ln-1015"></a>      <span class="c">!+ Dry bulb temperature in R [IP] or K [SI]</span>
<a name="ln-1016"></a>
<a name="ln-1017"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1018"></a><span class="k">      if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">14</span><span class="mf">8.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">TDryBulb</span> <span class="o">&gt;</span> <span class="mi">39</span><span class="mf">2.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1019"></a><span class="k">        </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: dry bulb temperature must be in range [-148, 392]°F&quot;</span>
<a name="ln-1020"></a>      <span class="k">end if</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a><span class="k">      </span><span class="n">T</span> <span class="o">=</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-1023"></a>
<a name="ln-1024"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_IP</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1025"></a><span class="k">        </span><span class="n">LnPws</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0214165E+04</span> <span class="o">/</span> <span class="n">T</span> <span class="o">-</span> <span class="mf">4.8932428</span> <span class="o">-</span> <span class="mf">5.3765794E-03</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.9202377E-07</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span>    <span class="p">&amp;</span>
<a name="ln-1026"></a>                <span class="o">+</span> <span class="mf">3.5575832E-10</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">9.0344688E-14</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">*</span> <span class="nb">log</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<a name="ln-1027"></a>      <span class="k">else</span>
<a name="ln-1028"></a><span class="k">        </span><span class="n">LnPws</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0440397E+04</span> <span class="o">/</span> <span class="n">T</span> <span class="o">-</span> <span class="mf">1.1294650E+01</span> <span class="o">-</span> <span class="mf">2.7022355E-02</span><span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.2890360E-05</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span>  <span class="p">&amp;</span>
<a name="ln-1029"></a>                <span class="o">-</span> <span class="mf">2.4780681E-09</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">*</span> <span class="nb">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-1030"></a>      <span class="k">end if</span>
<a name="ln-1031"></a>
<a name="ln-1032"></a><span class="k">      else</span>
<a name="ln-1033"></a><span class="k">        if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">10</span><span class="mf">0.0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">TDryBulb</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1034"></a><span class="k">          </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: dry bulb temperature must be in range [-100, 200]°C&quot;</span>
<a name="ln-1035"></a>        <span class="k">end if</span>
<a name="ln-1036"></a>
<a name="ln-1037"></a><span class="k">        </span><span class="n">T</span> <span class="o">=</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-1038"></a>
<a name="ln-1039"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">TDryBulb</span> <span class="o">&lt;=</span> <span class="n">TRIPLE_POINT_WATER_SI</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1040"></a><span class="k">          </span><span class="n">LnPws</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.6745359E+03</span> <span class="o">/</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">6.3925247</span> <span class="o">-</span> <span class="mf">9.677843E-03</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">6.2215701E-07</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span>    <span class="p">&amp;</span>
<a name="ln-1041"></a>                  <span class="o">+</span> <span class="mf">2.0747825E-09</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">9.484024E-13</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">4.1635019</span> <span class="o">*</span> <span class="nb">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-1042"></a>        <span class="k">else</span>
<a name="ln-1043"></a><span class="k">          </span><span class="n">LnPws</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.8002206E+03</span> <span class="o">/</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">1.3914993</span> <span class="o">-</span> <span class="mf">4.8640239E-02</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="mf">4.1764768E-05</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-1044"></a>                  <span class="o">-</span> <span class="mf">1.4452093E-08</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">6.5459673</span> <span class="o">*</span> <span class="nb">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-1045"></a>        <span class="k">end if</span>
<a name="ln-1046"></a><span class="k">      end if</span>
<a name="ln-1047"></a>
<a name="ln-1048"></a><span class="k">    </span><span class="n">SatVapPres</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">LnPws</span><span class="p">)</span>
<a name="ln-1049"></a>  <span class="k">end function </span><span class="n">GetSatVapPres</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>  <span class="k">function </span><span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">SatHumRatio</span><span class="p">)</span>
<a name="ln-1052"></a>    <span class="c">!+ Return humidity ratio of saturated air given dry-bulb temperature and pressure.</span>
<a name="ln-1053"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1054"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 36, solved for W</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1057"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1058"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1059"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1060"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">SatHumRatio</span>
<a name="ln-1061"></a>      <span class="c">!+ Humidity ratio of saturated air in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1062"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">SatVaporPres</span>
<a name="ln-1063"></a>      <span class="c">!+ Vapor pressure of saturated air in in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a>    <span class="n">SatVaporPres</span>  <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-1066"></a>    <span class="n">SatHumRatio</span>   <span class="o">=</span> <span class="mf">0.621945</span> <span class="o">*</span> <span class="n">SatVaporPres</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pressure</span><span class="o">-</span><span class="n">SatVaporPres</span><span class="p">)</span>
<a name="ln-1067"></a>
<a name="ln-1068"></a>    <span class="c">! Validity check.</span>
<a name="ln-1069"></a>    <span class="n">SatHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">SatHumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-1070"></a>  <span class="k">end function </span><span class="n">GetSatHumRatio</span>
<a name="ln-1071"></a>
<a name="ln-1072"></a>  <span class="k">function </span><span class="n">GetSatAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">SatAirEnthalpy</span><span class="p">)</span>
<a name="ln-1073"></a>    <span class="c">!+ Return saturated air enthalpy given dry-bulb temperature and pressure.</span>
<a name="ln-1074"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1075"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1</span>
<a name="ln-1076"></a>
<a name="ln-1077"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1078"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1079"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1080"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1081"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">SatAirEnthalpy</span>
<a name="ln-1082"></a>      <span class="c">!+ Saturated air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a>    <span class="n">SatAirEnthalpy</span> <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">))</span>
<a name="ln-1085"></a>  <span class="k">end function </span><span class="n">GetSatAirEnthalpy</span>
<a name="ln-1086"></a>
<a name="ln-1087"></a>
<a name="ln-1088"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-1089"></a>  <span class="c">! Moist Air Calculations</span>
<a name="ln-1090"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-1091"></a>
<a name="ln-1092"></a>  <span class="k">function </span><span class="n">GetVaporPressureDeficit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">VaporPressureDeficit</span><span class="p">)</span>
<a name="ln-1093"></a>    <span class="c">!+ Return Vapor pressure deficit given dry-bulb temperature, humidity ratio, and pressure.</span>
<a name="ln-1094"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1095"></a>    <span class="c">!+ Oke (1987) eqn 2.13a</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1098"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1099"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1100"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1101"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1102"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1103"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">VaporPressureDeficit</span>
<a name="ln-1104"></a>      <span class="c">!+ Vapor pressure deficit in Psi [IP] or Pa [SI]</span>
<a name="ln-1105"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-1106"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-1107"></a>
<a name="ln-1108"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1109"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-1110"></a>    <span class="k">end if</span>
<a name="ln-1111"></a>
<a name="ln-1112"></a><span class="k">    </span><span class="n">RelHum</span> <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1113"></a>    <span class="n">VaporPressureDeficit</span> <span class="o">=</span> <span class="n">GetSatVapPres</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">RelHum</span><span class="p">)</span>
<a name="ln-1114"></a>  <span class="k">end function </span><span class="n">GetVaporPressureDeficit</span>
<a name="ln-1115"></a>
<a name="ln-1116"></a>  <span class="k">function </span><span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">DegreeOfSaturation</span><span class="p">)</span>
<a name="ln-1117"></a>    <span class="c">!+ Return the degree of saturation (i.e humidity ratio of the air / humidity ratio of the air at saturation</span>
<a name="ln-1118"></a>    <span class="c">!+ at the same temperature and pressure) given dry-bulb temperature, humidity ratio, and atmospheric pressure.</span>
<a name="ln-1119"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1120"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2009) ch. 1 eqn 12</span>
<a name="ln-1121"></a>    <span class="c">!+ Notes:</span>
<a name="ln-1122"></a>    <span class="c">!+ This definition is absent from the 2017 Handbook. Using 2009 version instead.</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1125"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1126"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1127"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1128"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1129"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1130"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">DegreeOfSaturation</span>
<a name="ln-1131"></a>      <span class="c">!+ Degree of saturation in arbitrary unit</span>
<a name="ln-1132"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-1133"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-1134"></a>
<a name="ln-1135"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1136"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-1137"></a>    <span class="k">end if</span>
<a name="ln-1138"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-1139"></a>
<a name="ln-1140"></a>    <span class="n">DegreeOfSaturation</span> <span class="o">=</span> <span class="n">BoundedHumRatio</span> <span class="o">/</span> <span class="n">GetSatHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1141"></a>  <span class="k">end function </span><span class="n">GetDegreeOfSaturation</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a>  <span class="k">function </span><span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">MoistAirEnthalpy</span><span class="p">)</span>
<a name="ln-1144"></a>    <span class="c">!+ Return moist air enthalpy given dry-bulb temperature and humidity ratio.</span>
<a name="ln-1145"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1146"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30</span>
<a name="ln-1147"></a>
<a name="ln-1148"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1149"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1150"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1151"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1152"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">MoistAirEnthalpy</span>
<a name="ln-1153"></a>      <span class="c">!+ Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹</span>
<a name="ln-1154"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-1155"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-1156"></a>
<a name="ln-1157"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1158"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-1159"></a>    <span class="k">end if</span>
<a name="ln-1160"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-1161"></a>
<a name="ln-1162"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1163"></a><span class="k">        </span><span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="mf">0.240</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span> <span class="o">*</span> <span class="p">(</span><span class="mi">106</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.444</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-1164"></a>    <span class="k">else</span>
<a name="ln-1165"></a><span class="k">        </span><span class="n">MoistAirEnthalpy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.006</span> <span class="o">*</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span> <span class="o">*</span> <span class="p">(</span><span class="mi">250</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.86</span> <span class="o">*</span> <span class="n">TDryBulb</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0</span>
<a name="ln-1166"></a>    <span class="k">end if</span>
<a name="ln-1167"></a><span class="k">  end function </span><span class="n">GetMoistAirEnthalpy</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a>  <span class="k">function </span><span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">MoistAirVolume</span><span class="p">)</span>
<a name="ln-1170"></a>    <span class="c">!+ Return moist air specific volume given dry-bulb temperature, humidity ratio, and pressure.</span>
<a name="ln-1171"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1172"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 26</span>
<a name="ln-1173"></a>    <span class="c">!+ Notes:</span>
<a name="ln-1174"></a>    <span class="c">!+ In IP units, R_DA_IP / 144 equals 0.370486 which is the coefficient appearing in eqn 26</span>
<a name="ln-1175"></a>    <span class="c">!+ The factor 144 is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>
<a name="ln-1176"></a>
<a name="ln-1177"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1178"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1179"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1180"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1181"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1182"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1183"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">MoistAirVolume</span>
<a name="ln-1184"></a>      <span class="c">!+ Specific volume of moist air in ft³ lb⁻¹ of dry air [IP] or in m³ kg⁻¹ of dry air [SI]</span>
<a name="ln-1185"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-1186"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1189"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-1190"></a>    <span class="k">end if</span>
<a name="ln-1191"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-1192"></a>
<a name="ln-1193"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1194"></a><span class="k">        </span><span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">R_DA_IP</span> <span class="o">*</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">14</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1195"></a>    <span class="k">else</span>
<a name="ln-1196"></a><span class="k">        </span><span class="n">MoistAirVolume</span> <span class="o">=</span> <span class="n">R_DA_SI</span> <span class="o">*</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pressure</span>
<a name="ln-1197"></a>    <span class="k">end if</span>
<a name="ln-1198"></a><span class="k">  end function </span><span class="n">GetMoistAirVolume</span>
<a name="ln-1199"></a>
<a name="ln-1200"></a>  <span class="k">function </span><span class="n">GetTDryBulbFromMoistAirVolumeAndHumRatio</span><span class="p">(</span><span class="n">MoistAirVolume</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-1201"></a>    <span class="c">!+ Return dry-bulb temperature given moist air specific volume, humidity ratio, and pressure.</span>
<a name="ln-1202"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1203"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 26</span>
<a name="ln-1204"></a>    <span class="c">!+ Notes:</span>
<a name="ln-1205"></a>    <span class="c">!+ In IP units, R_DA_IP / 144 equals 0.370486 which is the coefficient appearing in eqn 26</span>
<a name="ln-1206"></a>    <span class="c">!+ The factor 144 is for the conversion of Psi = lb in⁻² to lb ft⁻².</span>
<a name="ln-1207"></a>    <span class="c">!+ Based on the `GetMoistAirVolume` function, rearranged for dry-bulb temperature.</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">MoistAirVolume</span>
<a name="ln-1210"></a>      <span class="c">!+ Specific volume of moist air in ft³ lb⁻¹ of dry air [IP] or in m³ kg⁻¹ of dry air [SI]</span>
<a name="ln-1211"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1212"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1213"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1214"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1215"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1216"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1217"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-1218"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1221"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-1222"></a>    <span class="k">end if</span>
<a name="ln-1223"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-1224"></a>
<a name="ln-1225"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1226"></a><span class="k">      </span><span class="n">TDryBulb</span> <span class="o">=</span> <span class="n">GetTFahrenheitFromTRankine</span><span class="p">(</span><span class="n">MoistAirVolume</span> <span class="o">*</span> <span class="p">(</span><span class="mi">144</span> <span class="o">*</span> <span class="n">Pressure</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1227"></a>                                <span class="o">/</span> <span class="p">(</span><span class="n">R_DA_IP</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)))</span>
<a name="ln-1228"></a>    <span class="k">else</span>
<a name="ln-1229"></a><span class="k">      </span><span class="n">TDryBulb</span> <span class="o">=</span> <span class="n">GetTCelsiusFromTKelvin</span><span class="p">(</span><span class="n">MoistAirVolume</span> <span class="o">*</span> <span class="n">Pressure</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                                <span class="o">/</span> <span class="p">(</span><span class="n">R_DA_SI</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.607858</span> <span class="o">*</span> <span class="n">BoundedHumRatio</span><span class="p">)))</span>
<a name="ln-1231"></a>    <span class="k">end if</span>
<a name="ln-1232"></a><span class="k">  end function </span><span class="n">GetTDryBulbFromMoistAirVolumeAndHumRatio</span>
<a name="ln-1233"></a>
<a name="ln-1234"></a>  <span class="k">function </span><span class="n">GetMoistAirDensity</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">MoistAirDensity</span><span class="p">)</span>
<a name="ln-1235"></a>    <span class="c">!+ Return moist air density given humidity ratio, dry bulb temperature, and pressure.</span>
<a name="ln-1236"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1237"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 11</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1240"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1241"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1242"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1243"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1244"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1245"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">MoistAirDensity</span>
<a name="ln-1246"></a>      <span class="c">!+ Moist air density in lb ft⁻³ [IP] or kg m⁻³ [SI]</span>
<a name="ln-1247"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">BoundedHumRatio</span>
<a name="ln-1248"></a>      <span class="c">!+ Humidity ratio bounded to MIN_HUM_RATIO</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">HumRatio</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1251"></a><span class="k">      </span><span class="n">error</span> <span class="k">stop</span> <span class="s2">&quot;Error: humidity ratio is negative&quot;</span>
<a name="ln-1252"></a>    <span class="k">end if</span>
<a name="ln-1253"></a><span class="k">    </span><span class="n">BoundedHumRatio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">MIN_HUM_RATIO</span><span class="p">)</span>
<a name="ln-1254"></a>
<a name="ln-1255"></a>    <span class="n">MoistAirDensity</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">BoundedHumRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">BoundedHumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1256"></a>  <span class="k">end function </span><span class="n">GetMoistAirDensity</span>
<a name="ln-1257"></a>
<a name="ln-1258"></a>
<a name="ln-1259"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-1260"></a>  <span class="c">! Standard atmosphere</span>
<a name="ln-1261"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-1262"></a>
<a name="ln-1263"></a>  <span class="k">function </span><span class="n">GetStandardAtmPressure</span><span class="p">(</span><span class="n">Altitude</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">StandardAtmPressure</span><span class="p">)</span>
<a name="ln-1264"></a>    <span class="c">!+ Return standard atmosphere barometric pressure, given the elevation (altitude).</span>
<a name="ln-1265"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1266"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 3</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Altitude</span>
<a name="ln-1269"></a>      <span class="c">!+ Altitude in ft [IP] or m [SI]</span>
<a name="ln-1270"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">StandardAtmPressure</span>
<a name="ln-1271"></a>      <span class="c">!+ Standard atmosphere barometric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1274"></a><span class="k">        </span><span class="n">StandardAtmPressure</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">4.696</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">6.8754e-06</span> <span class="o">*</span> <span class="n">Altitude</span><span class="p">)</span><span class="o">**</span><span class="mf">5.2559</span>
<a name="ln-1275"></a>    <span class="k">else</span>
<a name="ln-1276"></a><span class="k">        </span><span class="n">StandardAtmPressure</span> <span class="o">=</span> <span class="mi">101325</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">2.25577e-05</span> <span class="o">*</span> <span class="n">Altitude</span><span class="p">)</span><span class="o">**</span><span class="mf">5.2559</span>
<a name="ln-1277"></a>    <span class="k">end if</span>
<a name="ln-1278"></a><span class="k">  end function </span><span class="n">GetStandardAtmPressure</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a>  <span class="k">function </span><span class="n">GetStandardAtmTemperature</span><span class="p">(</span><span class="n">Altitude</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">StandardAtmTemperature</span><span class="p">)</span>
<a name="ln-1281"></a>    <span class="c">!+ Return standard atmosphere temperature, given the elevation (altitude).</span>
<a name="ln-1282"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1283"></a>    <span class="c">!+ ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 4</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Altitude</span>
<a name="ln-1286"></a>      <span class="c">!+ Altitude in ft [IP] or m [SI]</span>
<a name="ln-1287"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">StandardAtmTemperature</span>
<a name="ln-1288"></a>      <span class="c">!+ Standard atmosphere dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1289"></a>
<a name="ln-1290"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1291"></a><span class="k">        </span><span class="n">StandardAtmTemperature</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">9.0</span> <span class="o">-</span> <span class="mf">0.00356620</span> <span class="o">*</span> <span class="n">Altitude</span>
<a name="ln-1292"></a>    <span class="k">else</span>
<a name="ln-1293"></a><span class="k">        </span><span class="n">StandardAtmTemperature</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">5.0</span> <span class="o">-</span> <span class="mf">0.0065</span> <span class="o">*</span> <span class="n">Altitude</span>
<a name="ln-1294"></a>    <span class="k">end if</span>
<a name="ln-1295"></a><span class="k">  end function </span><span class="n">GetStandardAtmTemperature</span>
<a name="ln-1296"></a>
<a name="ln-1297"></a>  <span class="k">function </span><span class="n">GetSeaLevelPressure</span><span class="p">(</span><span class="n">StnPressure</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">SeaLevelPressure</span><span class="p">)</span>
<a name="ln-1298"></a>    <span class="c">!+ Return sea level pressure given dry-bulb temperature, altitude above sea level and pressure.</span>
<a name="ln-1299"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1300"></a>    <span class="c">!+ Hess SL, Introduction to theoretical meteorology, Holt Rinehart and Winston, NY 1959,</span>
<a name="ln-1301"></a>    <span class="c">!+ ch. 6.5; Stull RB, Meteorology for scientists and engineers, 2nd edition,</span>
<a name="ln-1302"></a>    <span class="c">!+ Brooks/Cole 2000, ch. 1.</span>
<a name="ln-1303"></a>    <span class="c">!+ Notes:</span>
<a name="ln-1304"></a>    <span class="c">!+ The standard procedure for the US is to use for TDryBulb the average</span>
<a name="ln-1305"></a>    <span class="c">!+ of the current station temperature and the station temperature from 12 hours ago.</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">StnPressure</span>
<a name="ln-1308"></a>      <span class="c">!+ Observed station pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1309"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Altitude</span>
<a name="ln-1310"></a>      <span class="c">!+ Altitude in ft [IP] or m [SI]</span>
<a name="ln-1311"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1312"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1313"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">SeaLevelPressure</span>
<a name="ln-1314"></a>      <span class="c">!+ Sea level barometric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1315"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">TColumn</span>
<a name="ln-1316"></a>      <span class="c">!+ Average temperature in column of air in R [IP] or K [SI]</span>
<a name="ln-1317"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">H</span>
<a name="ln-1318"></a>      <span class="c">!+ scale height (dimensionless)</span>
<a name="ln-1319"></a>
<a name="ln-1320"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">isIP</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-1321"></a>      <span class="c">! Calculate average temperature in column of air, assuming a lapse rate</span>
<a name="ln-1322"></a>      <span class="c">! of 3.6 °F/1000ft</span>
<a name="ln-1323"></a>      <span class="n">TColumn</span> <span class="o">=</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="mf">0.0036</span> <span class="o">*</span> <span class="n">Altitude</span> <span class="o">/</span> <span class="mf">2.0</span>
<a name="ln-1324"></a>
<a name="ln-1325"></a>      <span class="c">! Determine the scale height</span>
<a name="ln-1326"></a>      <span class="n">H</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">3.351</span> <span class="o">*</span> <span class="n">GetTRankineFromTFahrenheit</span><span class="p">(</span><span class="n">TColumn</span><span class="p">)</span>
<a name="ln-1327"></a>    <span class="k">else</span>
<a name="ln-1328"></a>      <span class="c">! Calculate average temperature in column of air, assuming a lapse rate</span>
<a name="ln-1329"></a>      <span class="c">! of 6.5 °C/km</span>
<a name="ln-1330"></a>      <span class="n">TColumn</span> <span class="o">=</span> <span class="n">TDryBulb</span> <span class="o">+</span> <span class="mf">0.0065</span> <span class="o">*</span> <span class="n">Altitude</span> <span class="o">/</span> <span class="mf">2.0</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a>      <span class="c">! Determine the scale height</span>
<a name="ln-1333"></a>      <span class="n">H</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">7.055</span> <span class="o">*</span> <span class="n">GetTKelvinFromTCelsius</span><span class="p">(</span><span class="n">TColumn</span><span class="p">)</span> <span class="o">/</span> <span class="mf">9.807</span>
<a name="ln-1334"></a>    <span class="k">end if</span>
<a name="ln-1335"></a>
<a name="ln-1336"></a>    <span class="c">! Calculate the sea level pressure</span>
<a name="ln-1337"></a>    <span class="n">SeaLevelPressure</span> <span class="o">=</span> <span class="n">StnPressure</span> <span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="n">Altitude</span> <span class="o">/</span> <span class="n">H</span><span class="p">)</span>
<a name="ln-1338"></a>  <span class="k">end function </span><span class="n">GetSeaLevelPressure</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a>  <span class="k">function </span><span class="n">GetStationPressure</span><span class="p">(</span><span class="n">SeaLevelPressure</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">StationPressure</span><span class="p">)</span>
<a name="ln-1341"></a>    <span class="c">!+ Return station pressure from sea level pressure.</span>
<a name="ln-1342"></a>    <span class="c">!+ Reference:</span>
<a name="ln-1343"></a>    <span class="c">!+ See &#39;GetSeaLevelPressure&#39;</span>
<a name="ln-1344"></a>    <span class="c">!+ Notes:</span>
<a name="ln-1345"></a>    <span class="c">!+ This function is just the inverse of &#39;GetSeaLevelPressure&#39;.</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">SeaLevelPressure</span>
<a name="ln-1348"></a>      <span class="c">!+ Sea level barometric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1349"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Altitude</span>
<a name="ln-1350"></a>      <span class="c">!+ Altitude in ft [IP] or m [SI]</span>
<a name="ln-1351"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1352"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1353"></a>    <span class="kt">real</span>              <span class="kd">::</span>  <span class="n">StationPressure</span>
<a name="ln-1354"></a>      <span class="c">!+ Station pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1355"></a>
<a name="ln-1356"></a>    <span class="n">StationPressure</span> <span class="o">=</span> <span class="n">SeaLevelPressure</span> <span class="o">/</span> <span class="n">GetSeaLevelPressure</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">,</span> <span class="n">TDryBulb</span><span class="p">)</span>
<a name="ln-1357"></a>  <span class="k">end function </span><span class="n">GetStationPressure</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>
<a name="ln-1360"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-1361"></a>  <span class="c">! Functions to set all psychrometric values</span>
<a name="ln-1362"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>  <span class="k">subroutine </span><span class="n">CalcPsychrometricsFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1365"></a>                                            <span class="n">TWetBulb</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1366"></a>                                            <span class="n">Pressure</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1367"></a>                                            <span class="n">HumRatio</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1368"></a>                                            <span class="n">TDewPoint</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1369"></a>                                            <span class="n">RelHum</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-1370"></a>                                            <span class="n">VapPres</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-1371"></a>                                            <span class="n">MoistAirEnthalpy</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1372"></a>                                            <span class="n">MoistAirVolume</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1373"></a>                                            <span class="n">DegreeOfSaturation</span><span class="p">)</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a>    <span class="c">!+ Utility function to calculate humidity ratio, dew-point temperature, relative humidity,</span>
<a name="ln-1376"></a>    <span class="c">!+ vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given</span>
<a name="ln-1377"></a>    <span class="c">!+ dry-bulb temperature, wet-bulb temperature, and pressure.</span>
<a name="ln-1378"></a>
<a name="ln-1379"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1380"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1381"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-1382"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1383"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1384"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1385"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1386"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1387"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-1388"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-1389"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-1390"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-1391"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-1392"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-1393"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">MoistAirEnthalpy</span>
<a name="ln-1394"></a>      <span class="c">!+ Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<a name="ln-1395"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">MoistAirVolume</span>
<a name="ln-1396"></a>      <span class="c">!+ Specific volume of moist air in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<a name="ln-1397"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">DegreeOfSaturation</span>
<a name="ln-1398"></a>      <span class="c">!+ Degree of saturation [unitless]</span>
<a name="ln-1399"></a>
<a name="ln-1400"></a>    <span class="n">HumRatio</span>            <span class="o">=</span> <span class="n">GetHumRatioFromTWetBulb</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">TWetBulb</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1401"></a>    <span class="n">TDewPoint</span>           <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1402"></a>    <span class="n">RelHum</span>              <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1403"></a>    <span class="n">VapPres</span>             <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1404"></a>    <span class="n">MoistAirEnthalpy</span>    <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-1405"></a>    <span class="n">MoistAirVolume</span>      <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1406"></a>    <span class="n">DegreeOfSaturation</span>  <span class="o">=</span> <span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1407"></a>  <span class="k">end subroutine </span><span class="n">CalcPsychrometricsFromTWetBulb</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a>  <span class="k">subroutine </span><span class="n">CalcPsychrometricsFromTDewPoint</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1410"></a>                                             <span class="n">TDewPoint</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1411"></a>                                             <span class="n">Pressure</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1412"></a>                                             <span class="n">HumRatio</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1413"></a>                                             <span class="n">TWetBulb</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1414"></a>                                             <span class="n">RelHum</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-1415"></a>                                             <span class="n">VapPres</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-1416"></a>                                             <span class="n">MoistAirEnthalpy</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1417"></a>                                             <span class="n">MoistAirVolume</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1418"></a>                                             <span class="n">DegreeOfSaturation</span><span class="p">)</span>
<a name="ln-1419"></a>
<a name="ln-1420"></a>    <span class="c">!+ Utility function to calculate humidity ratio, wet-bulb temperature, relative humidity,</span>
<a name="ln-1421"></a>    <span class="c">!+ vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given</span>
<a name="ln-1422"></a>    <span class="c">!+ dry-bulb temperature, dew-point temperature, and pressure.</span>
<a name="ln-1423"></a>
<a name="ln-1424"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1425"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1426"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-1427"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-1428"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1429"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1430"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1431"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1432"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-1433"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1434"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-1435"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-1436"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-1437"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-1438"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">MoistAirEnthalpy</span>
<a name="ln-1439"></a>      <span class="c">!+ Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<a name="ln-1440"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">MoistAirVolume</span>
<a name="ln-1441"></a>      <span class="c">!+ Specific volume of moist air in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<a name="ln-1442"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">DegreeOfSaturation</span>
<a name="ln-1443"></a>      <span class="c">!+ Degree of saturation [unitless]</span>
<a name="ln-1444"></a>
<a name="ln-1445"></a>    <span class="n">HumRatio</span>            <span class="o">=</span> <span class="n">GetHumRatioFromTDewPoint</span><span class="p">(</span><span class="n">TDewPoint</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1446"></a>    <span class="n">TWetBulb</span>            <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1447"></a>    <span class="n">RelHum</span>              <span class="o">=</span> <span class="n">GetRelHumFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1448"></a>    <span class="n">VapPres</span>             <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1449"></a>    <span class="n">MoistAirEnthalpy</span>    <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-1450"></a>    <span class="n">MoistAirVolume</span>      <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1451"></a>    <span class="n">DegreeOfSaturation</span>  <span class="o">=</span> <span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1452"></a>  <span class="k">end subroutine </span><span class="n">CalcPsychrometricsFromTDewPoint</span>
<a name="ln-1453"></a>
<a name="ln-1454"></a>  <span class="k">subroutine </span><span class="n">CalcPsychrometricsFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1455"></a>                                          <span class="n">RelHum</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-1456"></a>                                          <span class="n">Pressure</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1457"></a>                                          <span class="n">HumRatio</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1458"></a>                                          <span class="n">TWetBulb</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1459"></a>                                          <span class="n">TDewPoint</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1460"></a>                                          <span class="n">VapPres</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-1461"></a>                                          <span class="n">MoistAirEnthalpy</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1462"></a>                                          <span class="n">MoistAirVolume</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1463"></a>                                          <span class="n">DegreeOfSaturation</span><span class="p">)</span>
<a name="ln-1464"></a>
<a name="ln-1465"></a>    <span class="c">!+ Utility function to calculate humidity ratio, wet-bulb temperature, dew-point temperature,</span>
<a name="ln-1466"></a>    <span class="c">!+ vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given</span>
<a name="ln-1467"></a>    <span class="c">!+ dry-bulb temperature, relative humidity and pressure.</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">TDryBulb</span>
<a name="ln-1470"></a>      <span class="c">!+ Dry-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1471"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">RelHum</span>
<a name="ln-1472"></a>      <span class="c">!+ Relative humidity in range [0, 1]</span>
<a name="ln-1473"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">Pressure</span>
<a name="ln-1474"></a>      <span class="c">!+ Atmospheric pressure in Psi [IP] or Pa [SI]</span>
<a name="ln-1475"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">HumRatio</span>
<a name="ln-1476"></a>      <span class="c">!+ Humidity ratio in lb_H₂O lb_Air⁻¹ [IP] or kg_H₂O kg_Air⁻¹ [SI]</span>
<a name="ln-1477"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">TWetBulb</span>
<a name="ln-1478"></a>      <span class="c">!+ Wet-bulb temperature in °F [IP] or °C [SI]</span>
<a name="ln-1479"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">TDewPoint</span>
<a name="ln-1480"></a>      <span class="c">!+ Dew-point temperature in °F [IP] or °C [SI]</span>
<a name="ln-1481"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">VapPres</span>
<a name="ln-1482"></a>      <span class="c">!+ Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]</span>
<a name="ln-1483"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">MoistAirEnthalpy</span>
<a name="ln-1484"></a>      <span class="c">!+ Moist air enthalpy in Btu lb⁻¹ [IP] or J kg⁻¹ [SI]</span>
<a name="ln-1485"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">MoistAirVolume</span>
<a name="ln-1486"></a>      <span class="c">!+ Specific volume of moist air in ft³ lb⁻¹ [IP] or in m³ kg⁻¹ [SI]</span>
<a name="ln-1487"></a>    <span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>   <span class="kd">::</span>  <span class="n">DegreeOfSaturation</span>
<a name="ln-1488"></a>      <span class="c">!+ Degree of saturation [unitless]</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a>    <span class="n">HumRatio</span>            <span class="o">=</span> <span class="n">GetHumRatioFromRelHum</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">RelHum</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1491"></a>    <span class="n">TWetBulb</span>            <span class="o">=</span> <span class="n">GetTWetBulbFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1492"></a>    <span class="n">TDewPoint</span>           <span class="o">=</span> <span class="n">GetTDewPointFromHumRatio</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1493"></a>    <span class="n">VapPres</span>             <span class="o">=</span> <span class="n">GetVapPresFromHumRatio</span><span class="p">(</span><span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1494"></a>    <span class="n">MoistAirEnthalpy</span>    <span class="o">=</span> <span class="n">GetMoistAirEnthalpy</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">)</span>
<a name="ln-1495"></a>    <span class="n">MoistAirVolume</span>      <span class="o">=</span> <span class="n">GetMoistAirVolume</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1496"></a>    <span class="n">DegreeOfSaturation</span>  <span class="o">=</span> <span class="n">GetDegreeOfSaturation</span><span class="p">(</span><span class="n">TDryBulb</span><span class="p">,</span> <span class="n">HumRatio</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">)</span>
<a name="ln-1497"></a>  <span class="k">end subroutine </span><span class="n">CalcPsychrometricsFromRelHum</span>
<a name="ln-1498"></a>
<a name="ln-1499"></a>
<a name="ln-1500"></a><span class="k">end module </span><span class="n">psychrolib</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> MinimalDX was developed by dmey</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>